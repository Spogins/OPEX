/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 6.0.0 (TBD)
 */
!function(){"use strict";const e=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(o=n=e,(r=String).prototype.isPrototypeOf(o)||(null===(l=n.constructor)||void 0===l?void 0:l.name)===r.name)?"string":t;var o,n,r,l})(t)===e,t=e=>t=>typeof t===e,o=e=>t=>e===t,n=e("string"),r=e("object"),l=e("array"),s=o(null),a=t("boolean"),c=o(void 0),i=e=>!(e=>null==e)(e),d=t("function"),u=t("number");class m{constructor(e,t){this.tag=e,this.value=t}static some(e){return new m(!0,e)}static none(){return m.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?m.some(e(this.value)):m.none()}bind(e){return this.tag?e(this.value):m.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:m.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return i(e)?m.some(e):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);const p=()=>{},g=e=>()=>e,f=e=>e,b=(e,t)=>e===t;function h(e,...t){return(...o)=>{const n=t.concat(o);return e.apply(null,n)}}const w=e=>t=>!e(t),y=e=>e(),v=g(!1),C=g(!0),S=Array.prototype.slice,x=Array.prototype.indexOf,T=Array.prototype.push,R=(e,t)=>{return o=e,n=t,x.call(o,n)>-1;var o,n},D=(e,t)=>{for(let o=0,n=e.length;o<n;o++)if(t(e[o],o))return!0;return!1},O=(e,t)=>{const o=[];for(let n=0;n<e;n++)o.push(t(n));return o},A=(e,t)=>{const o=e.length,n=new Array(o);for(let r=0;r<o;r++){const o=e[r];n[r]=t(o,r)}return n},k=(e,t)=>{for(let o=0,n=e.length;o<n;o++)t(e[o],o)},B=(e,t)=>{const o=[],n=[];for(let r=0,l=e.length;r<l;r++){const l=e[r];(t(l,r)?o:n).push(l)}return{pass:o,fail:n}},I=(e,t)=>{const o=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t(r,n)&&o.push(r)}return o},M=(e,t,o)=>(((e,t)=>{for(let o=e.length-1;o>=0;o--)t(e[o],o)})(e,((e,n)=>{o=t(o,e,n)})),o),_=(e,t,o)=>(k(e,((e,n)=>{o=t(o,e,n)})),o),E=(e,t)=>((e,t,o)=>{for(let n=0,r=e.length;n<r;n++){const r=e[n];if(t(r,n))return m.some(r);if(o(r,n))break}return m.none()})(e,t,v),N=(e,t)=>{for(let o=0,n=e.length;o<n;o++)if(t(e[o],o))return m.some(o);return m.none()},P=e=>{const t=[];for(let o=0,n=e.length;o<n;++o){if(!l(e[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+e);T.apply(t,e[o])}return t},z=(e,t)=>P(A(e,t)),L=(e,t)=>{for(let o=0,n=e.length;o<n;++o)if(!0!==t(e[o],o))return!1;return!0},W=(e,t)=>{const o={};for(let n=0,r=e.length;n<r;n++){const r=e[n];o[String(r)]=t(r,n)}return o},j=e=>[e],F=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),H=e=>F(e,0),V=e=>F(e,e.length-1),q=(e,t)=>{for(let o=0;o<e.length;o++){const n=t(e[o],o);if(n.isSome())return n}return m.none()},$=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},U={fromHtml:(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return $(o.childNodes[0])},fromTag:(e,t)=>{const o=(t||document).createElement(e);return $(o)},fromText:(e,t)=>{const o=(t||document).createTextNode(e);return $(o)},fromDom:$,fromPoint:(e,t,o)=>m.from(e.dom.elementFromPoint(t,o)).map($)},G=(e,t)=>{const o=e.dom;if(1!==o.nodeType)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},K=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,Y=(e,t)=>{const o=void 0===t?document:t.dom;return K(o)?m.none():m.from(o.querySelector(e)).map(U.fromDom)},J=(e,t)=>e.dom===t.dom,Q=(e,t)=>{const o=e.dom,n=t.dom;return o!==n&&o.contains(n)},X=G,Z=Object.keys,ee=Object.hasOwnProperty,te=(e,t)=>{const o=Z(e);for(let n=0,r=o.length;n<r;n++){const r=o[n];t(e[r],r)}},oe=(e,t)=>ne(e,((e,o)=>({k:o,v:t(e,o)}))),ne=(e,t)=>{const o={};return te(e,((e,n)=>{const r=t(e,n);o[r.k]=r.v})),o},re=(e,t)=>{const o={};return((e,t,o,n)=>{te(e,((e,r)=>{(t(e,r)?o:n)(e,r)}))})(e,t,(e=>(t,o)=>{e[o]=t})(o),p),o},le=(e,t)=>{const o=[];return te(e,((e,n)=>{o.push(t(e,n))})),o},se=e=>le(e,f),ae=e=>Z(e).length,ce=(e,t)=>ie(e,t)?m.from(e[t]):m.none(),ie=(e,t)=>ee.call(e,t),de=(e,t)=>ie(e,t)&&void 0!==e[t]&&null!==e[t],ue=["tfoot","thead","tbody","colgroup"],me=(e,t,o)=>({element:e,rowspan:t,colspan:o}),pe=(e,t,o)=>({element:e,cells:t,section:o}),ge=(e,t,o)=>({element:e,isNew:t,isLocked:o}),fe=(e,t,o,n)=>({element:e,cells:t,section:o,isNew:n});"undefined"!=typeof window?window:Function("return this;")();const be=e=>e.dom.nodeName.toLowerCase(),he=e=>e.dom.nodeType,we=e=>t=>he(t)===e,ye=e=>8===he(e)||"#comment"===be(e),ve=we(1),Ce=we(3),Se=we(9),xe=we(11),Te=e=>t=>ve(t)&&be(t)===e,Re=e=>U.fromDom(e.dom.ownerDocument),De=e=>Se(e)?e:Re(e),Oe=e=>m.from(e.dom.parentNode).map(U.fromDom),Ae=(e,t)=>{const o=d(t)?t:v;let n=e.dom;const r=[];for(;null!==n.parentNode&&void 0!==n.parentNode;){const e=n.parentNode,t=U.fromDom(e);if(r.push(t),!0===o(t))break;n=e}return r},ke=e=>m.from(e.dom.previousSibling).map(U.fromDom),Be=e=>m.from(e.dom.nextSibling).map(U.fromDom),Ie=e=>A(e.dom.childNodes,U.fromDom),Me=(e,t)=>{const o=e.dom.childNodes;return m.from(o[t]).map(U.fromDom)},_e=d(Element.prototype.attachShadow)&&d(Node.prototype.getRootNode),Ee=g(_e),Ne=_e?e=>U.fromDom(e.dom.getRootNode()):De,Pe=e=>U.fromDom(e.dom.host),ze=e=>{const t=Ce(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return(e=>{const t=Ne(e);return xe(o=t)&&i(o.dom.host)?m.some(t):m.none();var o})(U.fromDom(t)).fold((()=>o.body.contains(t)),(n=ze,r=Pe,e=>n(r(e))));var n,r},Le=e=>{const t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return U.fromDom(t)},We=(e,t)=>{let o=[];return k(Ie(e),(e=>{t(e)&&(o=o.concat([e])),o=o.concat(We(e,t))})),o},je=(e,t,o)=>((e,o,n)=>I(Ae(e,n),(e=>G(e,t))))(e,0,o),Fe=(e,t)=>((e,o)=>I(Ie(e),(e=>G(e,t))))(e),He=(e,t)=>((e,t)=>{const o=void 0===t?document:t.dom;return K(o)?[]:A(o.querySelectorAll(e),U.fromDom)})(t,e);var Ve=(e,t,o,n,r)=>e(o,n)?m.some(o):d(r)&&r(o)?m.none():t(o,n,r);const qe=(e,t,o)=>{let n=e.dom;const r=d(o)?o:v;for(;n.parentNode;){n=n.parentNode;const e=U.fromDom(n);if(t(e))return m.some(e);if(r(e))break}return m.none()},$e=(e,t,o)=>qe(e,(e=>G(e,t)),o),Ue=(e,t)=>((e,o)=>E(e.dom.childNodes,(e=>{return o=U.fromDom(e),G(o,t);var o})).map(U.fromDom))(e),Ge=(e,t)=>Y(t,e),Ke=(e,t,o)=>Ve(((e,t)=>G(e,t)),$e,e,t,o),Ye=(e,t,o)=>{if(!(n(o)||a(o)||u(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},Je=(e,t,o)=>{Ye(e.dom,t,o)},Qe=(e,t)=>{const o=e.dom;te(t,((e,t)=>{Ye(o,t,e)}))},Xe=(e,t)=>{const o=e.dom.getAttribute(t);return null===o?void 0:o},Ze=(e,t)=>m.from(Xe(e,t)),et=(e,t)=>{e.dom.removeAttribute(t)},tt=e=>_(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),ot=(e,t,o=b)=>e.exists((e=>o(e,t))),nt=e=>{const t=[],o=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(o);return t},rt=(e,t,o)=>e.isSome()&&t.isSome()?m.some(o(e.getOrDie(),t.getOrDie())):m.none(),lt=(e,t)=>e?m.some(t):m.none(),st=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,at=(e,t)=>-1!==e.indexOf(t),ct=(e,t)=>st(e,t,0),it=(e,t)=>st(e,t,e.length-t.length),dt=(e=>t=>t.replace(e,""))(/^\s+|\s+$/g),ut=e=>e.length>0,mt=e=>void 0!==e.style&&d(e.style.getPropertyValue),pt=(e,t,o)=>{if(!n(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);mt(e)&&e.style.setProperty(t,o)},gt=(e,t,o)=>{const n=e.dom;pt(n,t,o)},ft=(e,t)=>{const o=e.dom;te(t,((e,t)=>{pt(o,t,e)}))},bt=(e,t)=>{const o=e.dom,n=window.getComputedStyle(o).getPropertyValue(t);return""!==n||ze(e)?n:ht(o,t)},ht=(e,t)=>mt(e)?e.style.getPropertyValue(t):"",wt=(e,t)=>{const o=e.dom,n=ht(o,t);return m.from(n).filter((e=>e.length>0))},yt=(e,t)=>{((e,t)=>{mt(e)&&e.style.removeProperty(t)})(e.dom,t),ot(Ze(e,"style").map(dt),"")&&et(e,"style")},vt=(e,t,o=0)=>Ze(e,t).map((e=>parseInt(e,10))).getOr(o),Ct=(e,t)=>vt(e,t,1),St=e=>Te("col")(e)?vt(e,"span",1)>1:Ct(e,"colspan")>1,xt=e=>Ct(e,"rowspan")>1,Tt=(e,t)=>parseInt(bt(e,t),10),Rt=g(10),Dt=g(10),Ot=(e,t)=>At(e,t,C),At=(e,t,o)=>z(Ie(e),(e=>G(e,t)?o(e)?[e]:[]:At(e,t,o))),kt=(e,t)=>((e,t,o=v)=>o(t)?m.none():R(e,be(t))?m.some(t):$e(t,e.join(","),(e=>G(e,"table")||o(e))))(["td","th"],e,t),Bt=e=>Ot(e,"th,td"),It=e=>G(e,"colgroup")?Fe(e,"col"):z(Et(e),(e=>Fe(e,"col"))),Mt=(e,t)=>Ke(e,"table",t),_t=e=>Ot(e,"tr"),Et=e=>Mt(e).fold(g([]),(e=>Fe(e,"colgroup"))),Nt=(e,t)=>A(e,(e=>{if("colgroup"===be(e)){const t=A(It(e),(e=>{const t=vt(e,"span",1);return me(e,1,t)}));return pe(e,t,"colgroup")}{const o=A(Bt(e),(e=>{const t=vt(e,"rowspan",1),o=vt(e,"colspan",1);return me(e,t,o)}));return pe(e,o,t(e))}})),Pt=e=>Oe(e).map((e=>{const t=be(e);return(e=>R(ue,e))(t)?t:"tbody"})).getOr("tbody"),zt=e=>{const t=_t(e),o=[...Et(e),...t];return Nt(o,Pt)},Lt=(e,t,o)=>{const n=e.cells,r=n.slice(0,t),l=n.slice(t),s=r.concat(o).concat(l);return Ft(e,s)},Wt=(e,t,o)=>Lt(e,t,[o]),jt=(e,t,o)=>{e.cells[t]=o},Ft=(e,t)=>fe(e.element,t,e.section,e.isNew),Ht=(e,t)=>e.cells[t],Vt=(e,t)=>Ht(e,t).element,qt=e=>e.cells.length,$t=e=>{const t=B(e,(e=>"colgroup"===e.section));return{rows:t.fail,cols:t.pass}},Ut=(e,t,o)=>{const n=A(e.cells,o);return fe(t(e.element),n,e.section,!0)},Gt="data-snooker-locked-cols",Kt=e=>Ze(e,Gt).bind((e=>m.from(e.match(/\d+/g)))).map((e=>W(e,C))),Yt=e=>{const t=_($t(e).rows,((e,t)=>(k(t.cells,((t,o)=>{t.isLocked&&(e[o]=!0)})),e)),{}),o=le(t,((e,t)=>parseInt(t,10)));return((e,t)=>{const o=S.call(e,0);return o.sort(void 0),o})(o)},Jt=(e,t)=>e+","+t,Qt=(e,t)=>{const o=z(e.all,(e=>e.cells));return I(o,t)},Xt=e=>{const t={},o=[],n=H(e).map((e=>e.element)).bind(Mt).bind(Kt).getOr({});let r=0,l=0,s=0;const{pass:a,fail:c}=B(e,(e=>"colgroup"===e.section));k(c,(e=>{const a=[];k(e.cells,(e=>{let o=0;for(;void 0!==t[Jt(s,o)];)o++;const r=de(n,o.toString()),c=((e,t,o,n,r,l)=>({element:e,rowspan:t,colspan:o,row:n,column:r,isLocked:l}))(e.element,e.rowspan,e.colspan,s,o,r);for(let n=0;n<e.colspan;n++)for(let r=0;r<e.rowspan;r++){const e=o+n,a=Jt(s+r,e);t[a]=c,l=Math.max(l,e+1)}a.push(c)})),r++,o.push(pe(e.element,a,e.section)),s++}));const{columns:i,colgroups:d}=V(a).map((e=>{const t=(e=>{const t={};let o=0;return k(e.cells,(e=>{const n=e.colspan;O(n,(r=>{const l=o+r;t[l]=((e,t,o)=>({element:e,colspan:t,column:o}))(e.element,n,l)})),o+=n})),t})(e),o=((e,t)=>({element:e,columns:t}))(e.element,se(t));return{colgroups:[o],columns:t}})).getOrThunk((()=>({colgroups:[],columns:{}}))),u=((e,t)=>({rows:e,columns:t}))(r,l);return{grid:u,access:t,all:o,columns:i,colgroups:d}},Zt=e=>{const t=zt(e);return Xt(t)},eo=Xt,to=(e,t,o)=>m.from(e.access[Jt(t,o)]),oo=(e,t,o)=>{const n=Qt(e,(e=>o(t,e.element)));return n.length>0?m.some(n[0]):m.none()},no=Qt,ro=e=>z(e.all,(e=>e.cells)),lo=e=>se(e.columns),so=e=>Z(e.columns).length>0,ao=(e,t)=>m.from(e.columns[t]),co=(e,t)=>{const o=t.column,n=t.column+t.colspan-1,r=t.row,l=t.row+t.rowspan-1;return o<=e.finishCol&&n>=e.startCol&&r<=e.finishRow&&l>=e.startRow},io=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,uo=(e,t,o)=>{const n=oo(e,t,J),r=oo(e,o,J);return n.bind((e=>r.map((t=>{return o=e,n=t,{startRow:Math.min(o.row,n.row),startCol:Math.min(o.column,n.column),finishRow:Math.max(o.row+o.rowspan-1,n.row+n.rowspan-1),finishCol:Math.max(o.column+o.colspan-1,n.column+n.colspan-1)};var o,n}))))},mo=(e,t,o)=>uo(e,t,o).map((t=>{const o=no(e,h(co,t));return A(o,(e=>e.element))})),po=(e,t)=>oo(e,t,((e,t)=>Q(t,e))).map((e=>e.element)),go=(e,t,o)=>{const n=bo(e);return mo(n,t,o)},fo=(e,t,o,n,r)=>{const l=bo(e),s=J(e,o)?m.some(t):po(l,t),a=J(e,r)?m.some(n):po(l,n);return s.bind((e=>a.bind((t=>mo(l,e,t)))))},bo=Zt,ho=(e,t)=>{Oe(e).each((o=>{o.dom.insertBefore(t.dom,e.dom)}))},wo=(e,t)=>{Be(e).fold((()=>{Oe(e).each((e=>{vo(e,t)}))}),(e=>{ho(e,t)}))},yo=(e,t)=>{const o=(e=>Me(e,0))(e);o.fold((()=>{vo(e,t)}),(o=>{e.dom.insertBefore(t.dom,o.dom)}))},vo=(e,t)=>{e.dom.appendChild(t.dom)},Co=(e,t)=>{ho(e,t),vo(t,e)},So=(e,t)=>{k(t,((o,n)=>{const r=0===n?e:t[n-1];wo(r,o)}))},xo=(e,t)=>{k(t,(t=>{vo(e,t)}))},To=e=>{e.dom.textContent="",k(Ie(e),(e=>{Ro(e)}))},Ro=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Do=e=>{const t=Ie(e);t.length>0&&So(e,t),Ro(e)},Oo=((e,t)=>{const o=t=>e(t)?m.from(t.dom.nodeValue):m.none();return{get:t=>{if(!e(t))throw new Error("Can only get text value of a text node");return o(t).getOr("")},getOption:o,set:(t,o)=>{if(!e(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=o}}})(Ce),Ao=e=>Oo.get(e),ko=e=>Oo.getOption(e),Bo=(e,t)=>Oo.set(e,t);var Io=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Mo=()=>({up:g({selector:$e,closest:Ke,predicate:qe,all:Ae}),down:g({selector:He,predicate:We}),styles:g({get:bt,getRaw:wt,set:gt,remove:yt}),attrs:g({get:Xe,set:Je,remove:et,copyTo:(e,t)=>{const o=tt(e);Qe(t,o)}}),insert:g({before:ho,after:wo,afterAll:So,append:vo,appendAll:xo,prepend:yo,wrap:Co}),remove:g({unwrap:Do,remove:Ro}),create:g({nu:U.fromTag,clone:e=>U.fromDom(e.dom.cloneNode(!1)),text:U.fromText}),query:g({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:ke,nextSibling:Be}),property:g({children:Ie,name:be,parent:Oe,document:e=>De(e).dom,isText:Ce,isComment:ye,isElement:ve,isSpecial:e=>{const t=be(e);return R(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>ve(e)?Ze(e,"lang"):m.none(),getText:Ao,setText:Bo,isBoundary:e=>!!ve(e)&&("body"===be(e)||R(Io,be(e))),isEmptyTag:e=>!!ve(e)&&R(["br","img","hr","input"],be(e)),isNonEditable:e=>ve(e)&&"false"===Xe(e,"contenteditable")}),eq:J,is:X});const _o=(e,t,o,n)=>{const r=t(e,o);return M(n,((o,n)=>{const r=t(e,n);return Eo(e,o,r)}),r)},Eo=(e,t,o)=>t.bind((t=>o.filter(h(e.eq,t)))),No=Mo(),Po=(e,t)=>((e,t,o)=>o.length>0?((e,t,o,n)=>n(e,t,o[0],o.slice(1)))(e,t,o,_o):m.none())(No,((t,o)=>e(o)),t),zo=e=>$e(e,"table"),Lo=(e,t,o)=>{const n=e=>t=>void 0!==o&&o(t)||J(t,e);return J(e,t)?m.some({boxes:m.some([e]),start:e,finish:t}):zo(e).bind((r=>zo(t).bind((l=>{if(J(r,l))return m.some({boxes:go(r,e,t),start:e,finish:t});if(Q(r,l)){const o=je(t,"td,th",n(r)),s=o.length>0?o[o.length-1]:t;return m.some({boxes:fo(r,e,r,t,l),start:e,finish:s})}if(Q(l,r)){const o=je(e,"td,th",n(l)),s=o.length>0?o[o.length-1]:e;return m.some({boxes:fo(l,e,r,t,l),start:e,finish:s})}return((e,t,o)=>((e,t,o,n=v)=>{const r=[t].concat(e.up().all(t)),l=[o].concat(e.up().all(o)),s=e=>N(e,n).fold((()=>e),(t=>e.slice(0,t+1))),a=s(r),c=s(l),i=E(a,(t=>D(c,((e,t)=>h(e.eq,t))(e,t))));return{firstpath:a,secondpath:c,shared:i}})(No,e,t,void 0))(e,t).shared.bind((s=>Ke(s,"table",o).bind((o=>{const s=je(t,"td,th",n(o)),a=s.length>0?s[s.length-1]:t,c=je(e,"td,th",n(o)),i=c.length>0?c[c.length-1]:e;return m.some({boxes:fo(o,e,r,t,l),start:i,finish:a})}))))}))))},Wo=(e,t)=>{const o=He(e,t);return o.length>0?m.some(o):m.none()},jo=(e,t,o)=>Ge(e,t).bind((t=>Ge(e,o).bind((e=>Po(zo,[t,e]).map((o=>({first:t,last:e,table:o}))))))),Fo=(e,t,o,n,r)=>((e,t)=>E(e,(e=>G(e,t))))(e,r).bind((e=>((e,t,o)=>Mt(e).bind((n=>((e,t,o,n)=>oo(e,t,J).bind((t=>{const r=o>0?t.row+t.rowspan-1:t.row,l=n>0?t.column+t.colspan-1:t.column;return to(e,r+o,l+n).map((e=>e.element))})))(bo(n),e,t,o))))(e,t,o).bind((e=>((e,t)=>$e(e,"table").bind((o=>Ge(o,t).bind((t=>Lo(t,e).bind((e=>e.boxes.map((t=>({boxes:t,start:e.start,finish:e.finish}))))))))))(e,n))))),Ho=(e,t)=>Wo(e,t),Vo=(e,t,o)=>jo(e,t,o).bind((t=>{const o=t=>J(e,t),n="thead,tfoot,tbody,table",r=$e(t.first,n,o),l=$e(t.last,n,o);return r.bind((e=>l.bind((o=>J(e,o)?((e,t,o)=>((e,t,o)=>uo(e,t,o).bind((t=>((e,t)=>{let o=!0;const n=h(io,t);for(let r=t.startRow;r<=t.finishRow;r++)for(let l=t.startCol;l<=t.finishCol;l++)o=o&&to(e,r,l).exists(n);return o?m.some(t):m.none()})(e,t))))(bo(e),t,o))(t.table,t.first,t.last):m.none()))))})),qo=e=>{if(!l(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],o={};return k(e,((n,r)=>{const s=Z(n);if(1!==s.length)throw new Error("one and only one name per case");const a=s[0],c=n[a];if(void 0!==o[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!l(c))throw new Error("case arguments must be an array");t.push(a),o[a]=(...o)=>{const n=o.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+n);return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[r].apply(null,o)},match:e=>{const n=Z(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!L(t,(e=>R(n,e))))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,o)},log:e=>{console.log(e,{constructors:t,constructor:a,params:o})}}}})),o},$o=qo([{none:[]},{multiple:["elements"]},{single:["element"]}]),Uo=(e,t,o,n)=>e.fold(t,o,n),Go=$o.none,Ko=$o.multiple,Yo=$o.single;var Jo=tinymce.util.Tools.resolve("tinymce.PluginManager");const Qo=(e,t)=>U.fromDom(e.dom.cloneNode(t)),Xo=e=>Qo(e,!1),Zo=e=>Qo(e,!0),en=(e,t)=>{const o=U.fromTag(t),n=tt(e);return Qe(o,n),o},tn=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},on=()=>nn(0,0),nn=(e,t)=>({major:e,minor:t}),rn={nu:nn,detect:(e,t)=>{const o=String(t).toLowerCase();return 0===e.length?on():((e,t)=>{const o=((e,t)=>{for(let o=0;o<e.length;o++){const n=e[o];if(n.test(t))return n}})(e,t);if(!o)return{major:0,minor:0};const n=e=>Number(t.replace(o,"$"+e));return nn(n(1),n(2))})(e,o)},unknown:on},ln=(e,t)=>{const o=String(t).toLowerCase();return E(e,(e=>e.search(o)))},sn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,an=e=>t=>at(t,e),cn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>at(e,"edge/")&&at(e,"chrome")&&at(e,"safari")&&at(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,sn],search:e=>at(e,"chrome")&&!at(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>at(e,"msie")||at(e,"trident")},{name:"Opera",versionRegexes:[sn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:an("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:an("firefox")},{name:"Safari",versionRegexes:[sn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(at(e,"safari")||at(e,"mobile/"))&&at(e,"applewebkit")}],dn=[{name:"Windows",search:an("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>at(e,"iphone")||at(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:an("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:an("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:an("linux"),versionRegexes:[]},{name:"Solaris",search:an("sunos"),versionRegexes:[]},{name:"FreeBSD",search:an("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:an("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],un={browsers:g(cn),oses:g(dn)},mn="Edge",pn="Chromium",gn="Opera",fn="Firefox",bn="Safari",hn=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n(mn),isChromium:n(pn),isIE:n("IE"),isOpera:n(gn),isFirefox:n(fn),isSafari:n(bn)}},wn=()=>hn({current:void 0,version:rn.unknown()}),yn=hn,vn=(g(mn),g(pn),g("IE"),g(gn),g(fn),g(bn),"Windows"),Cn="Android",Sn="Linux",xn="macOS",Tn="Solaris",Rn="FreeBSD",Dn="ChromeOS",On=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(vn),isiOS:n("iOS"),isAndroid:n(Cn),isMacOS:n(xn),isLinux:n(Sn),isSolaris:n(Tn),isFreeBSD:n(Rn),isChromeOS:n(Dn)}},An=()=>On({current:void 0,version:rn.unknown()}),kn=On,Bn=(g(vn),g("iOS"),g(Cn),g(Sn),g(xn),g(Tn),g(Rn),g(Dn),e=>window.matchMedia(e).matches);let In=tn((()=>((e,t,o)=>{const n=un.browsers(),r=un.oses(),l=t.bind((e=>((e,t)=>q(t.brands,(t=>{const o=t.brand.toLowerCase();return E(e,(e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:rn.nu(parseInt(t.version,10),0)})))})))(n,e))).orThunk((()=>((e,t)=>ln(e,t).map((e=>{const o=rn.detect(e.versionRegexes,t);return{current:e.name,version:o}})))(n,e))).fold(wn,yn),s=((e,t)=>ln(e,t).map((e=>{const o=rn.detect(e.versionRegexes,t);return{current:e.name,version:o}})))(r,e).fold(An,kn),a=((e,t,o,n)=>{const r=e.isiOS()&&!0===/ipad/i.test(o),l=e.isiOS()&&!r,s=e.isiOS()||e.isAndroid(),a=s||n("(pointer:coarse)"),c=r||!l&&s&&n("(min-device-width:768px)"),i=l||s&&!c,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o),u=!i&&!c&&!d;return{isiPad:g(r),isiPhone:g(l),isTablet:g(c),isPhone:g(i),isTouch:g(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:g(d),isDesktop:g(u)}})(s,l,e,o);return{browser:l,os:s,deviceType:a}})(navigator.userAgent,m.from(navigator.userAgentData),Bn)));const Mn=()=>In(),_n=(e,t)=>{const o=o=>{const n=t(o);if(n<=0||null===n){const t=bt(o,e);return parseFloat(t)||0}return n},n=(e,t)=>_(t,((t,o)=>{const n=bt(e,o),r=void 0===n?0:parseInt(n,10);return isNaN(r)?t:t+r}),0);return{set:(t,o)=>{if(!u(o)&&!o.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+o);const n=t.dom;mt(n)&&(n.style[e]=o+"px")},get:o,getOuter:o,aggregate:n,max:(e,t,o)=>{const r=n(e,o);return t>r?t-r:0}}},En=(e,t,o)=>((e,t)=>(e=>{const t=parseFloat(e);return isNaN(t)?m.none():m.some(t)})(e).getOr(t))(bt(e,t),o),Nn=_n("width",(e=>e.dom.offsetWidth)),Pn=e=>Nn.get(e),zn=e=>Nn.getOuter(e),Ln=e=>((e,t)=>{const o=e.dom,n=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?n:((e,t,o,n)=>t-En(e,"padding-left",0)-En(e,"padding-right",0)-En(e,"border-left-width",0)-En(e,"border-right-width",0))(e,n)})(e,"content-box"),Wn=(e,t=C)=>{const o=e.grid,n=O(o.columns,f),r=O(o.rows,f);return A(n,(o=>jn((()=>z(r,(t=>to(e,t,o).filter((e=>e.column===o)).toArray()))),(e=>1===e.colspan&&t(e.element)),(()=>to(e,0,o)))))},jn=(e,t,o)=>{const n=e();return E(n,t).orThunk((()=>m.from(n[0]).orThunk(o))).map((e=>e.element))},Fn=e=>{const t=e.grid,o=O(t.rows,f),n=O(t.columns,f);return A(o,(t=>jn((()=>z(n,(o=>to(e,t,o).filter((e=>e.row===t)).fold(g([]),(e=>[e]))))),(e=>1===e.rowspan),(()=>to(e,t,0)))))},Hn=(e,t)=>o=>"rtl"===Vn(o)?t:e,Vn=e=>"rtl"===bt(e,"direction")?"rtl":"ltr",qn=_n("height",(e=>{const t=e.dom;return ze(e)?t.getBoundingClientRect().height:t.offsetHeight})),$n=e=>qn.get(e),Un=e=>qn.getOuter(e),Gn=(e,t)=>({left:e,top:t,translate:(o,n)=>Gn(e+o,t+n)}),Kn=Gn,Yn=(e,t)=>void 0!==e?e:void 0!==t?t:0,Jn=e=>{const t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return Kn(o.offsetLeft,o.offsetTop);const l=Yn(null==n?void 0:n.pageYOffset,r.scrollTop),s=Yn(null==n?void 0:n.pageXOffset,r.scrollLeft),a=Yn(r.clientTop,o.clientTop),c=Yn(r.clientLeft,o.clientLeft);return Qn(e).translate(s-c,l-a)},Qn=e=>{const t=e.dom,o=t.ownerDocument.body;return o===t?Kn(o.offsetLeft,o.offsetTop):ze(e)?(e=>{const t=e.getBoundingClientRect();return Kn(t.left,t.top)})(t):Kn(0,0)},Xn=(e,t)=>({row:e,y:t}),Zn=(e,t)=>({col:e,x:t}),er=e=>Jn(e).left+zn(e),tr=e=>Jn(e).left,or=(e,t)=>Zn(e,tr(t)),nr=(e,t)=>Zn(e,er(t)),rr=e=>Jn(e).top,lr=(e,t)=>Xn(e,rr(t)),sr=(e,t)=>Xn(e,rr(t)+Un(t)),ar=(e,t,o)=>{if(0===o.length)return[];const n=A(o.slice(1),((t,o)=>t.map((t=>e(o,t))))),r=o[o.length-1].map((e=>t(o.length-1,e)));return n.concat([r])},cr={delta:f,positions:e=>ar(lr,sr,e),edge:rr},ir=Hn({delta:f,edge:tr,positions:e=>ar(or,nr,e)},{delta:e=>-e,edge:er,positions:e=>ar(nr,or,e)}),dr={delta:(e,t)=>ir(t).delta(e,t),positions:(e,t)=>ir(t).positions(e,t),edge:e=>ir(e).edge(e)},ur={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},mr=(()=>{const e="[0-9]+",t="[eE][+-]?[0-9]+",o=e=>`(?:${e})?`,n=["Infinity","[0-9]+\\."+o(e)+o(t),"\\.[0-9]+"+o(t),e+o(t)].join("|");return new RegExp(`^([+-]?(?:${n}))(.*)$`)})(),pr=/(\d+(\.\d+)?)%/,gr=/(\d+(\.\d+)?)px|em/,fr=Te("col"),br=(e,t,o)=>{const n=(r=e,m.from(r.dom.parentElement).map(U.fromDom)).getOrThunk((()=>Le(Re(e))));var r;return t(e)/o(n)*100},hr=(e,t)=>{gt(e,"width",t+"px")},wr=(e,t)=>{gt(e,"width",t+"%")},yr=(e,t)=>{gt(e,"height",t+"px")},vr=e=>{const t=(e=>{return En(t=e,"height",t.dom.offsetHeight)+"px";var t})(e);return t?((e,t,o,n)=>{const r=parseFloat(e);return it(e,"%")&&"table"!==be(t)?((e,t,o,n)=>{const r=Mt(e).map((e=>{const n=o(e);return Math.floor(t/100*n)})).getOr(t);return n(e,r),r})(t,r,o,n):r})(t,e,$n,yr):$n(e)},Cr=(e,t)=>wt(e,t).orThunk((()=>Ze(e,t).map((e=>e+"px")))),Sr=e=>Cr(e,"width"),xr=e=>br(e,Pn,Ln),Tr=e=>{return fr(e)?Pn(e):En(t=e,"width",t.dom.offsetWidth);var t},Rr=e=>((e,t,o)=>o(e)/Ct(e,"rowspan"))(e,0,vr),Dr=(e,t,o)=>{gt(e,"width",t+o)},Or=e=>br(e,Pn,Ln)+"%",Ar=g(pr),kr=Te("col"),Br=e=>Sr(e).getOrThunk((()=>Tr(e)+"px")),Ir=e=>{return(t=e,Cr(t,"height")).getOrThunk((()=>Rr(e)+"px"));var t},Mr=(e,t,o,n,r,l)=>e.filter(n).fold((()=>l(((e,t)=>{if(t<0||t>=e.length-1)return m.none();const o=e[t].fold((()=>{const o=(e=>{const t=S.call(e,0);return t.reverse(),t})(e.slice(0,t));return q(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>m.some({value:e,delta:0}))),n=e[t+1].fold((()=>{const o=e.slice(t+1);return q(o,((e,t)=>e.map((e=>({value:e,delta:t+1})))))}),(e=>m.some({value:e,delta:1})));return o.bind((e=>n.map((t=>{const o=t.delta+e.delta;return Math.abs(t.value-e.value)/o}))))})(o,t))),(e=>r(e))),_r=(e,t,o,n)=>{const r=Wn(e),l=so(e)?(e=>A(lo(e),(e=>m.from(e.element))))(e):r,s=[m.some(dr.edge(t))].concat(A(dr.positions(r,t),(e=>e.map((e=>e.x))))),a=w(St);return A(l,((e,t)=>Mr(e,t,s,a,(e=>{if((e=>{const t=Mn().browser,o=t.isChromium()||t.isFirefox();return!kr(e)||o})(e))return o(e);{const e=null!=(l=r[t])?f(l):m.none();return Mr(e,t,s,a,(e=>n(m.some(Pn(e)))),n)}var l}),n)))},Er=e=>e.map((e=>e+"px")).getOr(""),Nr=(e,t,o)=>_r(e,t,Tr,(e=>e.getOrThunk(o.minCellWidth))),Pr=(e,t,o,n,r)=>{const l=Fn(e),s=[m.some(o.edge(t))].concat(A(o.positions(l,t),(e=>e.map((e=>e.y)))));return A(l,((e,t)=>Mr(e,t,s,w(xt),n,r)))},zr=(e,t)=>()=>ze(e)?t(e):parseFloat(wt(e,"width").getOr("0")),Lr=e=>{const t=zr(e,(e=>parseFloat(Or(e)))),o=zr(e,Pn);return{width:t,pixelWidth:o,getWidths:(t,o)=>((e,t,o)=>_r(e,t,xr,(e=>e.fold((()=>o.minCellWidth()),(e=>e/o.pixelWidth()*100)))))(t,e,o),getCellDelta:e=>e/o()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>Rt()/o()*100,setElementWidth:wr,adjustTableWidth:o=>{const n=t();wr(e,n+o/100*n)},isRelative:!0,label:"percent"}},Wr=e=>{const t=zr(e,Pn);return{width:t,pixelWidth:t,getWidths:(t,o)=>Nr(t,e,o),getCellDelta:f,singleColumnWidth:(e,t)=>[Math.max(Rt(),e+t)-e],minCellWidth:Rt,setElementWidth:hr,adjustTableWidth:o=>{const n=t()+o;hr(e,n)},isRelative:!1,label:"pixel"}},jr=e=>Sr(e).fold((()=>(e=>{const t=zr(e,Pn),o=g(0);return{width:t,pixelWidth:t,getWidths:(t,o)=>Nr(t,e,o),getCellDelta:o,singleColumnWidth:g([0]),minCellWidth:o,setElementWidth:p,adjustTableWidth:p,isRelative:!0,label:"none"}})(e)),(t=>((e,t)=>null!==Ar().exec(t)?Lr(e):Wr(e))(e,t))),Fr=Wr,Hr=Lr,Vr=(e,t,o)=>{const n=e[o].element,r=U.fromTag("td");vo(r,U.fromTag("br")),(t?vo:yo)(n,r)},qr=e=>"img"===be(e)?1:ko(e).fold((()=>Ie(e).length),(e=>e.length)),$r=["img","br"],Ur=e=>ko(e).filter((e=>0!==e.trim().length||e.indexOf("\xa0")>-1)).isSome()||R($r,be(e)),Gr=e=>((e,t)=>{const o=e=>{for(let n=0;n<e.childNodes.length;n++){const r=U.fromDom(e.childNodes[n]);if(t(r))return m.some(r);const l=o(e.childNodes[n]);if(l.isSome())return l}return m.none()};return o(e.dom)})(e,Ur),Kr=e=>Yr(e,Ur),Yr=(e,t)=>{const o=e=>{const n=Ie(e);for(let e=n.length-1;e>=0;e--){const r=n[e];if(t(r))return m.some(r);const l=o(r);if(l.isSome())return l}return m.none()};return o(e)},Jr={scope:["row","col"]},Qr=e=>()=>{const t=U.fromTag("td",e.dom);return vo(t,U.fromTag("br",e.dom)),t},Xr=e=>()=>U.fromTag("col",e.dom),Zr=e=>()=>U.fromTag("colgroup",e.dom),el=e=>()=>U.fromTag("tr",e.dom),tl=(e,t,o)=>{const n=((e,t)=>{const o=en(e,t),n=Ie(Zo(e));return xo(o,n),o})(e,t);return te(o,((e,t)=>{null===e?et(n,t):Je(n,t,e)})),n},ol=e=>e,nl=(e,t,o)=>{const n=(e,t)=>{((e,t)=>{const o=e.dom,n=t.dom;mt(o)&&mt(n)&&(n.style.cssText=o.style.cssText)})(e.element,t),yt(t,"height"),1!==e.colspan&&yt(t,"width")};return{col:o=>{const r=U.fromTag(be(o.element),t.dom);return n(o,r),e(o.element,r),r},colgroup:Zr(t),row:el(t),cell:r=>{const l=U.fromTag(be(r.element),t.dom),s=o.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),a=s.length>0?((e,t,o)=>Gr(e).map((n=>{const r=o.join(","),l=je(n,r,(t=>J(t,e)));return M(l,((e,t)=>{const o=Xo(t);return et(o,"contenteditable"),vo(e,o),o}),t)})).getOr(t))(r.element,l,s):l;return vo(a,U.fromTag("br")),n(r,l),((e,t)=>{te(Jr,((o,n)=>Ze(e,n).filter((e=>R(o,e))).each((e=>Je(t,n,e)))))})(r.element,l),e(r.element,l),l},replace:tl,colGap:Xr(t),gap:Qr(t)}},rl=e=>({col:Xr(e),colgroup:Zr(e),row:el(e),cell:Qr(e),replace:ol,colGap:Xr(e),gap:Qr(e)}),ll=e=>A(e,U.fromDom),sl=e=>U.fromDom(e.getBody()),al=e=>e.getBoundingClientRect().width,cl=e=>e.getBoundingClientRect().height,il=e=>t=>J(t,sl(e)),dl=e=>/^\d+(\.\d+)?$/.test(e)?e+"px":e,ul=e=>{et(e,"data-mce-style");const t=e=>et(e,"data-mce-style");k(Bt(e),t),k(It(e),t),k(_t(e),t)},ml=e=>U.fromDom(e.selection.getStart()),pl=e=>Uo(e.get(),g([]),f,j),gl=e=>{const t=(e,t)=>Ze(e,t).exists((e=>parseInt(e,10)>1)),o=pl(e);return o.length>0&&L(o,(e=>t(e,"rowspan")||t(e,"colspan")))?m.some(o):m.none()},fl=(e,t,o)=>Uo(t.get(),m.none,(t=>t.length<=1?m.none():Vo(e,o.firstSelectedSelector,o.lastSelectedSelector).map((e=>({bounds:e,cells:t})))),m.none),bl={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},hl=(e,t,o)=>({element:o,mergable:fl(t,e,bl),unmergable:gl(e),selection:pl(e)}),wl=e=>(t,o)=>{const n=be(t),r="col"===n||"colgroup"===n?Mt(l=t).bind((e=>Ho(e,bl.firstSelectedSelector))).fold(g(l),(e=>e[0])):t;var l;return Ke(r,e,o)},yl=wl("th,td,caption"),vl=wl("th,td"),Cl=e=>pl(e),Sl=(e,t,o)=>{e.on("BeforeGetContent",(o=>{!0===o.selection&&Uo(t.get(),p,(t=>{o.preventDefault(),(e=>Mt(e[0]).map((e=>{const t=((e,t)=>{const o=e=>G(e.element,t),n=Zo(e),r=zt(n),l=jr(e),s=eo(r),a=((e,t)=>{const o=e.grid.columns;let n=e.grid.rows,r=o,l=0,s=0;const a=[],c=[];return te(e.access,(e=>{if(a.push(e),t(e)){c.push(e);const t=e.row,o=t+e.rowspan-1,a=e.column,i=a+e.colspan-1;t<n?n=t:o>l&&(l=o),a<r?r=a:i>s&&(s=i)}})),((e,t,o,n,r,l)=>({minRow:e,minCol:t,maxRow:o,maxCol:n,allCells:r,selectedCells:l}))(n,r,l,s,a,c)})(s,o),c="th:not("+t+"),td:not("+t+")",i=At(n,"th,td",(e=>G(e,c)));k(i,Ro),((e,t,o,n)=>{const r=t.grid.columns,l=t.grid.rows;for(let s=0;s<l;s++){let l=!1;for(let a=0;a<r;a++)s<o.minRow||s>o.maxRow||a<o.minCol||a>o.maxCol||(to(t,s,a).filter(n).isNone()?Vr(e,l,s):l=!0)}})(r,s,a,o);const d=((e,t,o,n)=>{if(0===n.minCol&&t.grid.columns===n.maxCol+1)return 0;const r=Nr(t,e,o),l=_(r,((e,t)=>e+t),0),s=_(r.slice(n.minCol,n.maxCol+1),((e,t)=>e+t),0),a=s/l*o.pixelWidth()-o.pixelWidth();return o.getCellDelta(a)})(e,Zt(e),l,a);return((e,t,o,n)=>{te(o.columns,(e=>{(e.column<t.minCol||e.column>t.maxCol)&&Ro(e.element)}));const r=I(Ot(e,"tr"),(e=>0===e.dom.childElementCount));k(r,Ro),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||k(Ot(e,"th,td"),(e=>{et(e,"rowspan"),et(e,"colspan")})),et(e,Gt),et(e,"data-snooker-col-series"),jr(e).adjustTableWidth(n)})(n,a,s,d),n})(e,"[data-mce-selected]");return ul(t),[t]})))(t).each((t=>{o.content="text"===o.format?(e=>A(e,(e=>e.dom.innerText)).join(""))(t):((e,t)=>A(t,(t=>e.selection.serializer.serialize(t.dom,{}))).join(""))(e,t)}))}),p)})),e.on("BeforeSetContent",(n=>{if(!0===n.selection&&!0===n.paste){const r=Cl(t);H(r).each((t=>{Mt(t).each((r=>{const l=I(((e,t)=>{const o=document.createElement("div");return o.innerHTML=e,Ie(U.fromDom(o))})(n.content),(e=>"meta"!==be(e))),s=Te("table");if(1===l.length&&s(l[0])){n.preventDefault();const s=U.fromDom(e.getDoc()),a=rl(s),c=((e,t,o)=>({element:e,clipboard:t,generators:o}))(t,l[0],a);o.pasteCells(r,c).each((()=>{e.focus()}))}}))}))}}))},xl={...qo([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},Tl=(e,t,o)=>{let n=0;for(let r=e;r<t;r++)n+=void 0!==o[r]?o[r]:0;return n},Rl=(e,t)=>{const o=ro(e);return A(o,(e=>{const o=Tl(e.row,e.row+e.rowspan,t);return{element:e.element,height:o,rowspan:e.rowspan}}))},Dl=(e,t,o)=>{const n=((e,t)=>so(e)?((e,t)=>{const o=lo(e);return A(o,((e,o)=>({element:e.element,width:t[o],colspan:e.colspan})))})(e,t):((e,t)=>{const o=ro(e);return A(o,(e=>{const o=Tl(e.column,e.column+e.colspan,t);return{element:e.element,width:o,colspan:e.colspan}}))})(e,t))(e,t);k(n,(e=>{o.setElementWidth(e.element,e.width)}))},Ol=(e,t,o,n,r)=>{const l=Zt(e),s=r.getCellDelta(t),a=r.getWidths(l,r),c=o===l.grid.columns-1,i=n.clampTableDelta(a,o,s,r.minCellWidth(),c),d=((e,t,o,n,r)=>{const l=e.slice(0),s=((e,t)=>0===e.length?xl.none():1===e.length?xl.only(0):0===t?xl.left(0,1):t===e.length-1?xl.right(t-1,t):t>0&&t<e.length-1?xl.middle(t-1,t,t+1):xl.none())(e,t),a=g(A(l,g(0)));return s.fold(a,(e=>n.singleColumnWidth(l[e],o)),((e,t)=>r.calcLeftEdgeDeltas(l,e,t,o,n.minCellWidth(),n.isRelative)),((e,t,s)=>r.calcMiddleDeltas(l,e,t,s,o,n.minCellWidth(),n.isRelative)),((e,t)=>r.calcRightEdgeDeltas(l,e,t,o,n.minCellWidth(),n.isRelative)))})(a,o,i,r,n),u=A(d,((e,t)=>e+a[t]));Dl(l,u,r),n.resizeTable(r.adjustTableWidth,i,c)},Al=e=>A(e,g(0)),kl=(e,t,o,n,r)=>r(e.slice(0,t)).concat(n).concat(r(e.slice(o))),Bl=e=>(t,o,n,r)=>{if(e(n)){const e=Math.max(r,t[o]-Math.abs(n)),l=Math.abs(e-t[o]);return n>=0?l:-l}return n},Il=Bl((e=>e<0)),Ml=Bl(C),_l=()=>{const e=(e,t,o,n)=>{const r=(100+o)/100,l=Math.max(n,(e[t]+o)/r);return A(e,((e,o)=>(o===t?l:e/r)-e))},t=(t,o,n,r,l,s)=>s?e(t,o,r,l):((e,t,o,n,r)=>{const l=Il(e,t,n,r);return kl(e,t,o+1,[l,0],Al)})(t,o,n,r,l);return{resizeTable:(e,t)=>e(t),clampTableDelta:Il,calcLeftEdgeDeltas:t,calcMiddleDeltas:(e,o,n,r,l,s,a)=>t(e,n,r,l,s,a),calcRightEdgeDeltas:(t,o,n,r,l,s)=>{if(s)return e(t,n,r,l);{const e=Il(t,n,r,l);return Al(t.slice(0,n)).concat([e])}},calcRedestributedWidths:(e,t,o,n)=>{if(n){const n=(t+o)/t,r=A(e,(e=>e/n));return{delta:100*n-100,newSizes:r}}return{delta:o,newSizes:e}}}},El=()=>{const e=(e,t,o,n,r)=>{const l=Ml(e,n>=0?o:t,n,r);return kl(e,t,o+1,[l,-l],Al)};return{resizeTable:(e,t,o)=>{o&&e(t)},clampTableDelta:(e,t,o,n,r)=>{if(r){if(o>=0)return o;{const t=_(e,((e,t)=>e+t-n),0);return Math.max(-t,o)}}return Il(e,t,o,n)},calcLeftEdgeDeltas:e,calcMiddleDeltas:(t,o,n,r,l,s)=>e(t,n,r,l,s),calcRightEdgeDeltas:(e,t,o,n,r,l)=>{if(l)return Al(e);{const t=n/e.length;return A(e,g(t))}},calcRedestributedWidths:(e,t,o,n)=>({delta:0,newSizes:e})}},Nl=(e,t)=>{const o=Se(e)?(e=>U.fromDom(De(e).dom.documentElement))(e):e;return{parent:g(o),view:g(e),origin:g(Kn(0,0)),isResizable:t}},Pl=qo([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),zl=(e,t,o)=>{const n=o.substring(0,o.length-e.length),r=parseFloat(n);return n===r.toString()?t(r):Pl.invalid(o)},Ll={...Pl,from:e=>it(e,"%")?zl("%",Pl.percent,e):it(e,"px")?zl("px",Pl.pixels,e):Pl.invalid(e)},Wl=(e,t,o)=>{const n=Ll.from(o),r=L(e,(e=>"0px"===e))?((e,t)=>{const o=e.fold((()=>g("")),(e=>g(e/t+"px")),(()=>g(100/t+"%")));return O(t,o)})(n,e.length):((e,t,o)=>e.fold((()=>t),(e=>((e,t,o)=>{const n=o/t;return A(e,(e=>Ll.from(e).fold((()=>e),(e=>e*n+"px"),(e=>e/100*o+"px"))))})(t,o,e)),(e=>((e,t)=>A(e,(e=>Ll.from(e).fold((()=>e),(e=>e/t*100+"%"),(e=>e+"%")))))(t,o))))(n,e,t);return Hl(r)},jl=(e,t)=>0===e.length?t:M(e,((e,t)=>Ll.from(t).fold(g(0),f,f)+e),0),Fl=(e,t)=>Ll.from(e).fold(g(e),(e=>e+t+"px"),(e=>e+t+"%")),Hl=e=>{if(0===e.length)return e;const t=M(e,((e,t)=>{const o=Ll.from(t).fold((()=>({value:t,remainder:0})),(e=>((e,t)=>{const o=Math.floor(e);return{value:o+"px",remainder:e-o}})(e)),(e=>({value:e+"%",remainder:0})));return{output:[o.value].concat(e.output),remainder:e.remainder+o.remainder}}),{output:[],remainder:0}),o=t.output;return o.slice(0,o.length-1).concat([Fl(o[o.length-1],Math.round(t.remainder))])},Vl=Ll.from,ql=e=>Vl(e).fold(g("px"),g("px"),g("%")),$l=(e,t,o)=>{const n=Zt(e),r=n.all,l=ro(n),s=lo(n);t.each((t=>{const o=ql(t),r=Pn(e),a=((e,t)=>_r(e,t,Br,Er))(n,e),c=Wl(a,r,t);so(n)?((e,t,o)=>{k(t,((t,n)=>{const r=jl([e[n]],Rt());gt(t.element,"width",r+o)}))})(c,s,o):((e,t,o)=>{k(t,(t=>{const n=e.slice(t.column,t.colspan+t.column),r=jl(n,Rt());gt(t.element,"width",r+o)}))})(c,l,o),gt(e,"width",t)})),o.each((t=>{const o=ql(t),s=$n(e),a=((e,t,o)=>Pr(e,t,o,Ir,Er))(n,e,cr);((e,t,o,n)=>{k(o,(t=>{const o=e.slice(t.row,t.rowspan+t.row),r=jl(o,Dt());gt(t.element,"height",r+n)})),k(t,((t,o)=>{gt(t.element,"height",e[o])}))})(Wl(a,s,t),r,l,o),gt(e,"height",t)}))},Ul=e=>Sr(e).exists((e=>pr.test(e))),Gl=e=>Sr(e).exists((e=>gr.test(e))),Kl=e=>Sr(e).isNone(),Yl=e=>Zt(e).grid,Jl=e=>{let t=[];return{bind:e=>{if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=I(t,(t=>t!==e))},trigger:(...o)=>{const n={};k(e,((e,t)=>{n[e]=o[t]})),k(t,(e=>{e(n)}))}}},Ql=e=>({registry:oe(e,(e=>({bind:e.bind,unbind:e.unbind}))),trigger:oe(e,(e=>e.trigger))}),Xl=e=>e.slice(0).sort(),Zl=(e,t)=>{const o=I(t,(t=>!R(e,t)));o.length>0&&(e=>{throw new Error("Unsupported keys for object: "+Xl(e).join(", "))})(o)},es=e=>((e,t)=>((e,t,o)=>{if(0===t.length)throw new Error("You must specify at least one required field.");return((e,t)=>{if(!l(t))throw new Error("The required fields must be an array. Was: "+t+".");k(t,(t=>{if(!n(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))})("required",t),(e=>{const t=Xl(e);E(t,((e,o)=>o<t.length-1&&e===t[o+1])).each((e=>{throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))})(t),n=>{const r=Z(n);L(t,(e=>R(r,e)))||((e,t)=>{throw new Error("All required keys ("+Xl(e).join(", ")+") were not specified. Specified keys were: "+Xl(t).join(", ")+".")})(t,r),e(t,r);const l=I(t,(e=>!o.validate(n[e],e)));return l.length>0&&((e,t)=>{throw new Error("All values need to be of type: "+t+". Keys ("+Xl(e).join(", ")+") were not.")})(l,o.label),n}})(e,t,{validate:d,label:"function"}))(Zl,e),ts=es(["compare","extract","mutate","sink"]),os=es(["element","start","stop","destroy"]),ns=es(["forceDrop","drop","move","delayDrop"]),rs=()=>{const e=(()=>{const e=Ql({move:Jl(["info"])});return{onEvent:p,reset:p,events:e.registry}})(),t=(()=>{let e=m.none();const t=Ql({move:Jl(["info"])});return{onEvent:(o,n)=>{n.extract(o).each((o=>{const r=((t,o)=>{const n=e.map((e=>t.compare(e,o)));return e=m.some(o),n})(n,o);r.each((e=>{t.trigger.move(e)}))}))},reset:()=>{e=m.none()},events:t.registry}})();let o=e;return{on:()=>{o.reset(),o=t},off:()=>{o.reset(),o=e},isOn:()=>o===t,onEvent:(e,t)=>{o.onEvent(e,t)},events:t.events}},ls=e=>{const t=U.fromDom((e=>{if(Ee()&&i(e.target)){const t=U.fromDom(e.target);if(ve(t)&&i(t.dom.shadowRoot)&&e.composed&&e.composedPath){const t=e.composedPath();if(t)return H(t)}}return m.from(e.target)})(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=(l=n,s=o,(...e)=>l(s.apply(null,e)));var l,s;return((e,t,o,n,r,l,s)=>({target:e,x:t,y:o,stop:n,prevent:r,kill:l,raw:s}))(t,e.clientX,e.clientY,o,n,r,e)},ss=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},as=C,cs=(e,t,o)=>((e,t,o,n)=>((e,t,o,n,r)=>{const l=((e,t)=>o=>{e(o)&&t(ls(o))})(o,n);return e.dom.addEventListener(t,l,r),{unbind:h(ss,e,t,l,r)}})(e,t,o,n,!1))(e,t,as,o),is=ls,ds=e=>void 0!==e.dom.classList,us=(e,t)=>((e,t,o)=>{const n=((e,t)=>{const o=Xe(e,t);return void 0===o||""===o?[]:o.split(" ")})(e,t).concat([o]);return Je(e,t,n.join(" ")),!0})(e,"class",t),ms=(e,t)=>{ds(e)?e.dom.classList.add(t):us(e,t)},ps=(e,t)=>ds(e)&&e.dom.classList.contains(t),gs=e=>{const t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},fs=gs("ephox-dragster").resolve;var bs=ts({compare:(e,t)=>Kn(t.left-e.left,t.top-e.top),extract:e=>m.some(Kn(e.x,e.y)),sink:(e,t)=>{const o=(e=>{const t={layerClass:fs("blocker"),...e},o=U.fromTag("div");return Je(o,"role","presentation"),ft(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ms(o,fs("blocker")),ms(o,t.layerClass),{element:g(o),destroy:()=>{Ro(o)}}})(t),n=cs(o.element(),"mousedown",e.forceDrop),r=cs(o.element(),"mouseup",e.drop),l=cs(o.element(),"mousemove",e.move),s=cs(o.element(),"mouseout",e.delayDrop);return os({element:o.element,start:e=>{vo(e,o.element())},stop:()=>{Ro(o.element())},destroy:()=>{o.destroy(),r.unbind(),l.unbind(),s.unbind(),n.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});const hs=e=>Ke(e,"[contenteditable]"),ws=(e,t=!1)=>ze(e)?e.dom.isContentEditable:hs(e).fold(g(t),(e=>"true"===ys(e))),ys=e=>e.dom.contentEditable,vs=gs("ephox-snooker").resolve,Cs=vs("resizer-bar"),Ss=vs("resizer-rows"),xs=vs("resizer-cols"),Ts=e=>{const t=He(e.parent(),"."+Cs);k(t,Ro)},Rs=(e,t,o)=>{const n=e.origin();k(t,(t=>{t.each((t=>{const r=o(n,t);ms(r,Cs),vo(e.parent(),r)}))}))},Ds=(e,t,o,n,r)=>{const l=Jn(o),s=t.isResizable,a=n.length>0?cr.positions(n,o):[],c=a.length>0?((e,t)=>z(e.all,((e,o)=>t(e.element)?[o]:[])))(e,s):[];((e,t,o,n)=>{Rs(e,t,((e,t)=>{const r=((e,t,o,n,r)=>{const l=U.fromTag("div");return ft(l,{position:"absolute",left:t+"px",top:o-3.5+"px",height:"7px",width:n+"px"}),Qe(l,{"data-row":e,role:"presentation"}),l})(t.row,o.left-e.left,t.y-e.top,n);return ms(r,Ss),r}))})(t,I(a,((e,t)=>D(c,(e=>t===e)))),l,zn(o));const i=r.length>0?dr.positions(r,o):[],d=i.length>0?((e,t)=>{const o=[];return O(e.grid.columns,(n=>{ao(e,n).map((e=>e.element)).forall(t)&&o.push(n)})),I(o,(o=>{const n=no(e,(e=>e.column===o));return L(n,(e=>t(e.element)))}))})(e,s):[];((e,t,o,n)=>{Rs(e,t,((e,t)=>{const r=((e,t,o,n,r)=>{const l=U.fromTag("div");return ft(l,{position:"absolute",left:t-3.5+"px",top:o+"px",height:r+"px",width:"7px"}),Qe(l,{"data-column":e,role:"presentation"}),l})(t.col,t.x-e.left,o.top-e.top,0,n);return ms(r,xs),r}))})(t,I(i,((e,t)=>D(d,(e=>t===e)))),l,Un(o))},Os=(e,t)=>{if(Ts(e),e.isResizable(t)){const o=Zt(t),n=Fn(o),r=Wn(o);Ds(o,e,t,n,r)}},As=(e,t)=>{const o=He(e.parent(),"."+Cs);k(o,t)},ks=e=>{As(e,(e=>{gt(e,"display","none")}))},Bs=e=>{As(e,(e=>{gt(e,"display","block")}))},Is=vs("resizer-bar-dragging"),Ms=e=>{const t=(()=>{const e=Ql({drag:Jl(["xDelta","yDelta","target"])});let t=m.none();const o=(()=>{const e=Ql({drag:Jl(["xDelta","yDelta"])});return{mutate:(t,o)=>{e.trigger.drag(t,o)},events:e.registry}})();return o.events.drag.bind((o=>{t.each((t=>{e.trigger.drag(o.xDelta,o.yDelta,t)}))})),{assign:e=>{t=m.some(e)},get:()=>t,mutate:o.mutate,events:e.registry}})(),o=((e,t={})=>{var o;return((e,t,o)=>{let n=!1;const r=Ql({start:Jl([]),stop:Jl([])}),l=rs(),a=()=>{d.stop(),l.isOn()&&(l.off(),r.trigger.stop())},c=((e,t)=>{let o=null;const n=()=>{s(o)||(clearTimeout(o),o=null)};return{cancel:n,throttle:(...t)=>{n(),o=setTimeout((()=>{o=null,e.apply(null,t)}),200)}}})(a);l.events.move.bind((o=>{t.mutate(e,o.info)}));const i=e=>(...t)=>{n&&e.apply(null,t)},d=t.sink(ns({forceDrop:a,drop:i(a),move:i((e=>{c.cancel(),l.onEvent(e,t)})),delayDrop:i(c.throttle)}),o);return{element:d.element,go:e=>{d.start(e),l.on(),r.trigger.start()},on:()=>{n=!0},off:()=>{n=!1},destroy:()=>{d.destroy()},events:r.registry}})(e,null!==(o=t.mode)&&void 0!==o?o:bs,t)})(t,{});let n=m.none();const r=(e,t)=>m.from(Xe(e,t));t.events.drag.bind((e=>{r(e.target,"data-row").each((t=>{const o=Tt(e.target,"top");gt(e.target,"top",o+e.yDelta+"px")})),r(e.target,"data-column").each((t=>{const o=Tt(e.target,"left");gt(e.target,"left",o+e.xDelta+"px")}))}));const l=(e,t)=>Tt(e,t)-vt(e,"data-initial-"+t,0);o.events.stop.bind((()=>{t.get().each((t=>{n.each((o=>{r(t,"data-row").each((e=>{const n=l(t,"top");et(t,"data-initial-top"),u.trigger.adjustHeight(o,n,parseInt(e,10))})),r(t,"data-column").each((e=>{const n=l(t,"left");et(t,"data-initial-left"),u.trigger.adjustWidth(o,n,parseInt(e,10))})),Os(e,o)}))}))}));const a=(n,r)=>{u.trigger.startAdjust(),t.assign(n),Je(n,"data-initial-"+r,Tt(n,r)),ms(n,Is),gt(n,"opacity","0.2"),o.go(e.parent())},c=cs(e.parent(),"mousedown",(e=>{var t;t=e.target,ps(t,Ss)&&a(e.target,"top"),(e=>ps(e,xs))(e.target)&&a(e.target,"left")})),i=t=>J(t,e.view()),d=cs(e.view(),"mouseover",(t=>{var o;(o=t.target,Ke(o,"table",i).filter(ws)).fold((()=>{ze(t.target)&&Ts(e)}),(t=>{n=m.some(t),Os(e,t)}))})),u=Ql({adjustHeight:Jl(["table","delta","row"]),adjustWidth:Jl(["table","delta","column"]),startAdjust:Jl([])});return{destroy:()=>{c.unbind(),d.unbind(),o.destroy(),Ts(e)},refresh:t=>{Os(e,t)},on:o.on,off:o.off,hideBars:h(ks,e),showBars:h(Bs,e),events:u.registry}},_s=(e,t,o)=>{const n=cr,r=dr,l=Ms(e),s=Ql({beforeResize:Jl(["table","type"]),afterResize:Jl(["table","type"]),startDrag:Jl([])});return l.events.adjustHeight.bind((e=>{const t=e.table;s.trigger.beforeResize(t,"row");((e,t,o,n)=>{const r=Zt(e),l=((e,t,o)=>Pr(e,t,o,Rr,(e=>e.getOrThunk(Dt))))(r,e,n),s=A(l,((e,n)=>o===n?Math.max(t+e,Dt()):e)),a=Rl(r,s),c=((e,t)=>A(e.all,((e,o)=>({element:e.element,height:t[o]}))))(r,s);k(c,(e=>{yr(e.element,e.height)})),k(a,(e=>{yr(e.element,e.height)}));const i=M(s,((e,t)=>e+t),0);yr(e,i)})(t,n.delta(e.delta,t),e.row,n),s.trigger.afterResize(t,"row")})),l.events.startAdjust.bind((e=>{s.trigger.startDrag()})),l.events.adjustWidth.bind((e=>{const n=e.table;s.trigger.beforeResize(n,"col");const l=r.delta(e.delta,n),a=o(n);Ol(n,l,e.column,t,a),s.trigger.afterResize(n,"col")})),{on:l.on,off:l.off,hideBars:l.hideBars,showBars:l.showBars,destroy:l.destroy,events:s.registry}},Es=(e,t)=>e.fire("newrow",{node:t}),Ns=(e,t)=>e.fire("newcell",{node:t}),Ps=(e,t,o)=>{e.fire("TableModified",{...o,table:t})},zs={structure:!1,style:!0},Ls={structure:!0,style:!1},Ws={structure:!0,style:!0};var js=tinymce.util.Tools.resolve("tinymce.Env");const Fs={border:"1"},Hs={"border-collapse":"collapse",width:"100%"},Vs=O(5,(e=>{const t=`${e+1}px`;return{title:t,value:t}})),qs=A(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(e=>({title:e,value:e.toLowerCase()}))),$s=e=>t=>t.options.get(e),Us=$s("table_sizing_mode"),Gs=$s("table_border_widths"),Ks=$s("table_border_styles"),Ys=$s("table_default_attributes"),Js=$s("table_resize_bars"),Qs=$s("table_tab_navigation"),Xs=$s("table_cell_advtab"),Zs=$s("table_row_advtab"),ea=$s("table_advtab"),ta=$s("table_appearance_options"),oa=$s("table_grid"),na=$s("table_style_by_css"),ra=$s("table_cell_class_list"),la=$s("table_row_class_list"),sa=$s("table_class_list"),aa=$s("table_toolbar"),ca=$s("table_use_colgroups"),ia=$s("table_header_type"),da=$s("table_column_resizing"),ua=$s("table_background_color_map"),ma=$s("table_border_color_map"),pa=e=>"relative"===Us(e),ga=e=>"fixed"===Us(e),fa=e=>"responsive"===Us(e),ba=e=>"preservetable"===da(e),ha=e=>"resizetable"===da(e),wa=e=>m.from(e.options.get("table_clone_elements")),ya=e=>{const t=e.options;return t.isSet("table_default_styles")?t.get("table_default_styles"):(e=>{var t;if(ga(e)){const o=e.dom,n=null!==(t=o.getParent(e.selection.getStart(),o.isBlock))&&void 0!==t?t:e.getBody(),r=Ln(U.fromDom(n));return{...Hs,width:r+"px"}}return fa(e)?re(Hs,((e,t)=>"width"!==t)):Hs})(e)},va=(e,t)=>pa(e)?Hr(t):ga(e)?Fr(t):jr(t),Ca=e=>{et(e,"width")},Sa=e=>{const t=Or(e);$l(e,m.some(t),m.none()),Ca(e)},xa=e=>{const t=(e=>Pn(e)+"px")(e);$l(e,m.some(t),m.none()),Ca(e)},Ta=e=>{yt(e,"width");const t=It(e),o=t.length>0?t:Bt(e);k(o,(e=>{yt(e,"width"),Ca(e)})),Ca(e)},Ra="bar-",Da=e=>"false"!==Xe(e,"data-mce-resize"),Oa=e=>{let t,o,n=m.none(),r=m.none(),l=m.none();const s=e=>"TABLE"===e.nodeName,a=()=>r,c=t=>va(e,t),i=()=>ba(e)?El():_l();return e.on("init",(()=>{const t=((e,t)=>e.inline?((e,t,o)=>({parent:g(t),view:g(e),origin:g(Kn(0,0)),isResizable:o}))(sl(e),(()=>{const e=U.fromTag("div");return ft(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),vo(Le(U.fromDom(document)),e),e})(),t):Nl(U.fromDom(e.getDoc()),t))(e,Da);if(l=m.some(t),(e=>{const t=e.options.get("object_resizing");return R(t.split(","),"table")})(e)&&Js(e)){const o=i(),l=_s(t,o,c);l.on(),l.events.startDrag.bind((t=>{n=m.some(e.selection.getRng())})),l.events.beforeResize.bind((t=>{const o=t.table.dom;((e,t,o,n,r)=>{e.fire("ObjectResizeStart",{target:t,width:o,height:n,origin:r})})(e,o,al(o),cl(o),Ra+t.type)})),l.events.afterResize.bind((t=>{const o=t.table,r=o.dom;ul(o),n.each((t=>{e.selection.setRng(t),e.focus()})),((e,t,o,n,r)=>{e.fire("ObjectResized",{target:t,width:o,height:n,origin:r})})(e,r,al(r),cl(r),Ra+t.type),e.undoManager.add()})),r=m.some(l)}})),e.on("ObjectResizeStart",(n=>{const r=n.target;if(s(r)){const l=U.fromDom(r);k(e.dom.select(".mce-clonedresizable"),(t=>{e.dom.addClass(t,"mce-"+da(e)+"-columns")})),!Gl(l)&&ga(e)?xa(l):!Ul(l)&&pa(e)&&Sa(l),Kl(l)&&ct(n.origin,Ra)&&Sa(l),t=n.width,o=fa(e)?"":((e,t)=>{const o=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return m.from(o).filter(ut)})(e,r).getOr("")}})),e.on("ObjectResized",(n=>{const r=n.target;if(s(r)){const l=U.fromDom(r),s=n.origin;ct(s,"corner-")&&((n,r,l)=>{const s=it(r,"e");if(""===o&&Sa(n),l!==t&&""!==o){gt(n,"width",o);const r=i(),a=c(n),d=ba(e)||s?(e=>Yl(e).columns)(n)-1:0;Ol(n,l-t,d,r,a)}else if((e=>/^(\d+(\.\d+)?)%$/.test(e))(o)){const e=parseFloat(o.replace("%",""));gt(n,"width",l*e/t+"%")}(e=>/^(\d+(\.\d+)?)px$/.test(e))(o)&&(e=>{const t=Zt(e);so(t)||k(Bt(e),(e=>{const t=bt(e,"width");gt(e,"width",t),et(e,"width")}))})(n)})(l,s,n.width),ul(l),Ps(e,l.dom,zs)}})),e.on("SwitchMode",(()=>{a().each((t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:a,lazyWire:()=>l.getOr(Nl(U.fromDom(e.getBody()),Da)),destroy:()=>{r.each((e=>{e.destroy()})),l.each((t=>{((e,t)=>{e.inline&&Ro(t.parent())})(e,t)}))}}},Aa=(e,t)=>({element:e,offset:t}),ka=(e,t,o)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?o(t).bind((t=>ka(e,t,o).orThunk((()=>m.some(t))))):m.none(),Ba=(e,t)=>e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,Ia=(e,t)=>{const o=ka(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(o))return Aa(o,Ba(e,o));const n=e.property().children(o);return n.length>0?Ia(e,n[n.length-1]):Aa(o,Ba(e,o))},Ma=Ia,_a=Mo(),Ea=(e,t)=>{if(!St(e)){const o=(e=>Sr(e).bind((e=>{return t=e,o=["fixed","relative","empty"],m.from(mr.exec(t)).bind((e=>{const t=Number(e[1]),n=e[2];return((e,t)=>D(t,(t=>D(ur[t],(t=>e===t)))))(n,o)?m.some({value:t,unit:n}):m.none()}));var t,o})))(e);o.each((o=>{const n=o.value/2;Dr(e,n,o.unit),Dr(t,n,o.unit)}))}},Na=Te("th"),Pa=e=>L(e,(e=>Na(e.element))),za=(e,t)=>e&&t?"sectionCells":e?"section":"cells",La=e=>{const t="thead"===e.section,o=ot(Wa(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:za(t,o)}:{type:"body"}},Wa=e=>{const t=I(e,(e=>Na(e.element)));return 0===t.length?m.some("td"):t.length===e.length?m.some("th"):m.none()},ja=(e,t,o)=>ge(o(e.element,t),!0,e.isLocked),Fa=(e,t)=>e.section!==t?fe(e.element,e.cells,t,e.isNew):e,Ha=()=>({transformRow:Fa,transformCell:(e,t,o)=>{const n=o(e.element,t),r="td"!==be(n)?((e,t)=>{const o=en(e,"td");wo(e,o);const n=Ie(e);return xo(o,n),Ro(e),o})(n):n;return ge(r,e.isNew,e.isLocked)}}),Va=()=>({transformRow:Fa,transformCell:ja}),qa=()=>({transformRow:(e,t)=>Fa(e,"thead"===t?"tbody":t),transformCell:ja}),$a=Ha,Ua=Va,Ga=qa,Ka=()=>({transformRow:f,transformCell:ja}),Ya=(e,t,o,n)=>{o===n?et(e,t):Je(e,t,o)},Ja=(e,t,o)=>{V(Fe(e,t)).fold((()=>yo(e,o)),(e=>wo(e,o)))},Qa=(e,t)=>{const o=[],n=[],r=e=>A(e,(e=>{e.isNew&&o.push(e.element);const t=e.element;return To(t),k(e.cells,(e=>{e.isNew&&n.push(e.element),Ya(e.element,"colspan",e.colspan,1),Ya(e.element,"rowspan",e.rowspan,1),vo(t,e.element)})),t})),l=e=>z(e,(e=>A(e.cells,(e=>(Ya(e.element,"span",e.colspan,1),e.element))))),s=(t,o)=>{const n=((e,t)=>{const o=Ue(e,t).getOrThunk((()=>{const o=U.fromTag(t,Re(e).dom);return"thead"===t?Ja(e,"caption,colgroup",o):"colgroup"===t?Ja(e,"caption",o):vo(e,o),o}));return To(o),o})(e,o),s=("colgroup"===o?l:r)(t);xo(n,s)},a=(t,o)=>{t.length>0?s(t,o):(t=>{Ue(e,t).each(Ro)})(o)},c=[],i=[],d=[],u=[];return k(t,(e=>{switch(e.section){case"thead":c.push(e);break;case"tbody":i.push(e);break;case"tfoot":d.push(e);break;case"colgroup":u.push(e)}})),a(u,"colgroup"),a(c,"thead"),a(i,"tbody"),a(d,"tfoot"),{newRows:o,newCells:n}},Xa=(e,t)=>{if(0===e.length)return 0;const o=e[0];return N(e,(e=>!t(o.element,e.element))).getOr(e.length)},Za=(e,t)=>{const o=A(e,(e=>A(e.cells,v)));return A(e,((n,r)=>{const l=z(n.cells,((n,l)=>{if(!1===o[r][l]){const d=((e,t,o,n)=>{const r=((e,t)=>e[t])(e,t),l="colgroup"===r.section,s=Xa(r.cells.slice(o),n),a=l?1:Xa(((e,t)=>A(e,(e=>Ht(e,t))))(e.slice(t),o),n);return{colspan:s,rowspan:a}})(e,r,l,t);return((e,t,n,r)=>{for(let l=e;l<e+n;l++)for(let e=t;e<t+r;e++)o[l][e]=!0})(r,l,d.rowspan,d.colspan),[(s=n.element,a=d.rowspan,c=d.colspan,i=n.isNew,{element:s,rowspan:a,colspan:c,isNew:i})]}return[];var s,a,c,i}));return((e,t,o,n)=>({element:e,cells:t,section:o,isNew:n}))(n.element,l,n.section,n.isNew)}))},ec=(e,t,o)=>{const n=[];k(e.colgroups,(r=>{const l=[];for(let n=0;n<e.grid.columns;n++){const r=ao(e,n).map((e=>ge(e.element,o,!1))).getOrThunk((()=>ge(t.colGap(),!0,!1)));l.push(r)}n.push(fe(r.element,l,"colgroup",o))}));for(let r=0;r<e.grid.rows;r++){const l=[];for(let n=0;n<e.grid.columns;n++){const s=to(e,r,n).map((e=>ge(e.element,o,e.isLocked))).getOrThunk((()=>ge(t.gap(),!0,!1)));l.push(s)}const s=e.all[r],a=fe(s.element,l,s.section,o);n.push(a)}return n},tc=e=>Za(e,J),oc=(e,t)=>q(e.all,(e=>E(e.cells,(e=>J(t,e.element))))),nc=(e,t,o)=>{const n=A(t.selection,(t=>kt(t).bind((t=>oc(e,t))).filter(o))),r=nt(n);return lt(r.length>0,r)},rc=(e,t,o,n,r)=>(l,s,a,c,i)=>{const d=Zt(s),u=m.from(null==i?void 0:i.section).getOrThunk(Ka);return t(d,a).map((t=>{const o=((e,t)=>ec(e,t,!1))(d,c),n=e(o,t,J,r(c),u),l=Yt(n.grid);return{info:t,grid:tc(n.grid),cursor:n.cursor,lockedColumns:l}})).bind((e=>{const t=Qa(s,e.grid),r=m.from(null==i?void 0:i.sizing).getOrThunk((()=>jr(s))),a=m.from(null==i?void 0:i.resize).getOrThunk(El);return o(s,e.grid,e.info,{sizing:r,resize:a,section:u}),n(s),Os(l,s),et(s,Gt),e.lockedColumns.length>0&&Je(s,Gt,e.lockedColumns.join(",")),m.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))},lc=(e,t)=>nc(e,t,C).map((e=>({cells:e,generators:t.generators,clipboard:t.clipboard}))),sc=(e,t)=>nc(e,t,C),ac=(e,t)=>nc(e,t,(e=>!e.isLocked)),cc=(e,t)=>L(t,(t=>((e,t)=>oc(e,t).exists((e=>!e.isLocked)))(e,t))),ic=(e,t)=>((e,t)=>t.mergable)(0,t).filter((t=>cc(e,t.cells))),dc=(e,t)=>((e,t)=>t.unmergable)(0,t).filter((t=>cc(e,t))),uc=(e,t,o,n)=>{const r=$t(e).rows;let l=!0;for(let e=0;e<r.length;e++)for(let s=0;s<qt(r[0]);s++){const a=r[e],c=Ht(a,s),i=o(c.element,t);i&&!l?jt(a,s,ge(n(),!0,c.isLocked)):i&&(l=!1)}return e},mc=e=>{const t=t=>t(e),o=g(e),n=()=>r,r={tag:!0,inner:e,fold:(t,o)=>o(e),isValue:C,isError:v,map:t=>gc.value(t(e)),mapError:n,bind:t,exists:t,forall:t,getOr:o,or:n,getOrThunk:o,orThunk:n,getOrDie:o,each:t=>{t(e)},toOptional:()=>m.some(e)};return r},pc=e=>{const t=()=>o,o={tag:!1,inner:e,fold:(t,o)=>t(e),isValue:v,isError:C,map:t,mapError:t=>gc.error(t(e)),bind:t,exists:v,forall:C,getOr:f,or:f,getOrThunk:y,orThunk:y,getOrDie:(n=String(e),()=>{throw new Error(n)}),each:p,toOptional:m.none};var n;return o},gc={value:mc,error:pc,fromOption:(e,t)=>e.fold((()=>pc(t)),mc)},fc=(e,t)=>({rowDelta:0,colDelta:qt(e[0])-qt(t[0])}),bc=(e,t)=>({rowDelta:e.length-t.length,colDelta:0}),hc=(e,t,o,n)=>{const r="colgroup"===t.section?o.col:o.cell;return O(e,(e=>ge(r(),!0,n(e))))},wc=(e,t,o,n)=>{const r=e[e.length-1];return e.concat(O(t,(()=>{const e="colgroup"===r.section?o.colgroup:o.row,t=Ut(r,e,f),l=hc(t.cells.length,t,o,(e=>ie(n,e.toString())));return Ft(t,l)})))},yc=(e,t,o,n)=>A(e,(e=>{const r=hc(t,e,o,v);return Lt(e,n,r)})),vc=(e,t,o)=>{const n=t.colDelta<0?yc:f,r=t.rowDelta<0?wc:f,l=Yt(e),s=qt(e[0]),a=D(l,(e=>e===s-1)),c=n(e,Math.abs(t.colDelta),o,a?s-1:s),i=Yt(c);return r(c,Math.abs(t.rowDelta),o,W(i,C))},Cc=(e,t,o,n)=>{const r=h(n,Ht(e[t],o).element),l=e[t];return e.length>1&&qt(l)>1&&(o>0&&r(Vt(l,o-1))||o<l.cells.length-1&&r(Vt(l,o+1))||t>0&&r(Vt(e[t-1],o))||t<e.length-1&&r(Vt(e[t+1],o)))},Sc=(e,t,o)=>I(o,(o=>o>=e.column&&o<=qt(t[0])+e.column)),xc=(e,t,o,n,r)=>{((e,t,o,n)=>{t>0&&t<e[0].cells.length&&k(e,(e=>{const r=e.cells[t-1],l=e.cells[t];o(l.element,r.element)&&jt(e,t,ge(n(),!0,l.isLocked))}))})(t,e,r,n.cell);const l=bc(o,t),s=vc(o,l,n),a=bc(t,s),c=vc(t,a,n);return A(c,((t,o)=>Lt(t,e,s[o].cells)))},Tc=(e,t,o,n,r)=>{((e,t,o,n)=>{const r=$t(e).rows;if(t>0&&t<r.length){const e=((e,t)=>_(e,((e,o)=>D(e,(e=>t(e.element,o.element)))?e:e.concat([o])),[]))(r[t-1].cells,o);k(e,(e=>{let l=m.none();for(let s=t;s<r.length;s++)for(let t=0;t<qt(r[0]);t++){const a=r[s],c=Ht(a,t);o(c.element,e.element)&&(l.isNone()&&(l=m.some(n())),l.each((e=>{jt(a,t,ge(e,!0,c.isLocked))})))}}))}})(t,e,r,n.cell);const l=Yt(t),s=fc(t,o),a={...s,colDelta:s.colDelta-l.length},c=vc(t,a,n),{cols:i,rows:d}=$t(c),u=Yt(c),p=fc(o,t),g={...p,colDelta:p.colDelta+u.length},f=(h=n,w=u,A(o,(e=>_(w,((t,o)=>{const n=hc(1,e,h,C)[0];return Wt(t,o,n)}),e)))),b=vc(f,g,n);var h,w;return[...i,...d.slice(0,e),...b,...d.slice(e,d.length)]},Rc=(e,t,o,n,r)=>{const{rows:l,cols:s}=$t(e),a=l.slice(0,t),c=l.slice(t);return[...s,...a,((e,t,o,n)=>Ut(e,(e=>n(e,o)),t))(l[o],((e,o)=>t>0&&t<l.length&&n(Vt(l[t-1],o),Vt(l[t],o))?Ht(l[t],o):ge(r(e.element,n),!0,e.isLocked)),n,r),...c]},Dc=(e,t,o,n,r)=>A(e,(e=>{const l=t>0&&t<qt(e)&&n(Vt(e,t-1),Vt(e,t)),s=((e,t,o,n,r,l,s)=>{if("colgroup"!==o&&n)return Ht(e,t);{const t=Ht(e,r);return ge(s(t.element,l),!0,!1)}})(e,t,e.section,l,o,n,r);return Wt(e,t,s)})),Oc=(e,t,o,n)=>((e,t,o,n)=>void 0!==Vt(e[t],o)&&t>0&&n(Vt(e[t-1],o),Vt(e[t],o)))(e,t,o,n)||((e,t,o)=>t>0&&o(Vt(e,t-1),Vt(e,t)))(e[t],o,n),Ac=(e,t,o,n)=>{const r=e=>(e=>"row"===e?xt(t):St(t))(e)?`${e}group`:e;return e?Na(t)?r(o):null:n&&Na(t)?r("row"===o?"col":"row"):null},kc=(e,t,o)=>ge(o(e.element,t),!0,e.isLocked),Bc=(e,t,o,n,r,l,s)=>A(e,((e,a)=>((e,c)=>{const i=e.cells,d=A(i,((e,c)=>{if((e=>D(t,(t=>o(e.element,t.element))))(e)){const t=s(e,a,c)?r(e,o,n):e;return l(t,a,c).each((e=>{var o,n;o=t.element,n={scope:m.from(e)},te(n,((e,t)=>{e.fold((()=>{et(o,t)}),(e=>{Ye(o.dom,t,e)}))}))})),t}return e}));return fe(e.element,d,e.section,e.isNew)})(e))),Ic=(e,t,o)=>z(e,((n,r)=>Oc(e,r,t,o)?[]:[Ht(n,t)])),Mc=(e,t,o,n,r)=>{const l=$t(e).rows,s=z(t,(e=>Ic(l,e,n))),a=A(l,(e=>Pa(e.cells))),c=((e,t)=>L(t,f)&&Pa(e)?C:(e,o,n)=>!("th"===be(e.element)&&t[o]))(s,a),i=((e,t)=>(o,n)=>m.some(Ac(e,o.element,"row",t[n])))(o,a);return Bc(e,s,n,r,kc,i,c)},_c=(e,t,o,n)=>{const r=$t(e).rows,l=A(t,(e=>Ht(r[e.row],e.column)));return Bc(e,l,o,n,kc,m.none,C)},Ec=e=>_(e,((e,t)=>D(e,(e=>e.column===t.column))?e:e.concat([t])),[]).sort(((e,t)=>e.column-t.column)),Nc=Te("col"),Pc=Te("colgroup"),zc=e=>"tr"===be(e)||Pc(e),Lc=e=>({element:e,colspan:vt(e,"colspan",1),rowspan:vt(e,"rowspan",1)}),Wc=e=>Ze(e,"scope").map((e=>e.substr(0,3))),jc=(e,t=Lc)=>{const o=o=>{if(zc(o))return Pc((r={element:o}).element)?e.colgroup(r):e.row(r);{const r=o,l=(t=>Nc(t.element)?e.col(t):e.cell(t))(t(r));return n=m.some({item:r,replacement:l}),l}var r};let n=m.none();return{getOrInit:(e,t)=>n.fold((()=>o(e)),(n=>t(e,n.item)?n.replacement:o(e)))}},Fc=e=>t=>{const o=[],n=n=>{const r="td"===e?{scope:null}:{},l=t.replace(n,e,r);return o.push({item:n,sub:l}),l};return{replaceOrInit:(e,t)=>{if(zc(e)||Nc(e))return e;{const r=e;return((e,t)=>E(o,(o=>t(o.item,e))))(r,t).fold((()=>n(r)),(o=>t(e,o.item)?o.sub:n(r)))}}}},Hc=e=>({unmerge:t=>{const o=Wc(t);return o.each((e=>Je(t,"scope",e))),()=>{const n=e.cell({element:t,colspan:1,rowspan:1});return yt(n,"width"),yt(t,"width"),o.each((e=>Je(n,"scope",e))),n}},merge:e=>(yt(e[0],"width"),(()=>{const t=nt(A(e,Wc));if(0===t.length)return m.none();{const e=t[0],o=["row","col"];return D(t,(t=>t!==e&&R(o,t)))?m.none():m.from(e)}})().fold((()=>et(e[0],"scope")),(t=>Je(e[0],"scope",t+"group"))),g(e[0]))}),Vc=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],qc=Mo(),$c=e=>((e,t)=>{const o=e.property().name(t);return R(Vc,o)})(qc,e),Uc=e=>((e,t)=>{const o=e.property().name(t);return R(["ol","ul"],o)})(qc,e),Gc=e=>{const t=Te("br"),o=e=>Kr(e).bind((o=>{const n=Be(o).map((e=>!!$c(e)||!!((e,t)=>R(["br","img","hr","input"],e.property().name(t)))(qc,e)&&"img"!==be(e))).getOr(!1);return Oe(o).map((r=>{return!0===n||("li"===be(l=r)||qe(l,Uc).isSome())||t(o)||$c(r)&&!J(e,r)?[]:[U.fromTag("br")];var l}))})).getOr([]),n=(()=>{const n=z(e,(e=>{const n=Ie(e);return(e=>L(e,(e=>t(e)||Ce(e)&&0===Ao(e).trim().length)))(n)?[]:n.concat(o(e))}));return 0===n.length?[U.fromTag("br")]:n})();To(e[0]),xo(e[0],n)},Kc=e=>ws(e,!0),Yc=e=>{0===Bt(e).length&&Ro(e)},Jc=(e,t)=>({grid:e,cursor:t}),Qc=(e,t,o)=>{const n=((e,t,o)=>{var n,r;const l=$t(e).rows;return m.from(null===(r=null===(n=l[t])||void 0===n?void 0:n.cells[o])||void 0===r?void 0:r.element).filter(Kc).orThunk((()=>(e=>q(e,(e=>q(e.cells,(e=>{const t=e.element;return lt(Kc(t),t)})))))(l)))})(e,t,o);return Jc(e,n)},Xc=e=>_(e,((e,t)=>D(e,(e=>e.row===t.row))?e:e.concat([t])),[]).sort(((e,t)=>e.row-t.row)),Zc=(e,t)=>(o,n,r,l,s)=>{const a=Xc(n),c=A(a,(e=>e.row)),i=((e,t,o,n,r,l,s)=>{const{cols:a,rows:c}=$t(e),i=c[t[0]],d=z(t,(e=>((e,t,o)=>{const n=e[t];return z(n.cells,((n,r)=>Oc(e,t,r,o)?[]:[n]))})(c,e,r))),u=A(i.cells,((e,t)=>Pa(Ic(c,t,r)))),p=[...c];k(t,(e=>{p[e]=s.transformRow(c[e],o)}));const g=[...a,...p],b=((e,t)=>L(t,f)&&Pa(e.cells)?C:(e,o,n)=>!("th"===be(e.element)&&t[n]))(i,u),h=((e,t)=>(o,n,r)=>m.some(Ac(e,o.element,"col",t[r])))(n,u);return Bc(g,d,r,l,s.transformCell,h,b)})(o,c,e,t,r,l.replaceOrInit,s);return Qc(i,n[0].row,n[0].column)},ei=Zc("thead",!0),ti=Zc("tbody",!1),oi=Zc("tfoot",!1),ni=(e,t,o)=>{const n=((e,t)=>Nt(e,(()=>t)))(e,o.section),r=eo(n);return ec(r,t,!0)},ri=(e,t,o,n)=>((e,t,o,n)=>{const r=eo(t),l=n.getWidths(r,n);Dl(r,l,n)})(0,t,0,n.sizing),li=(e,t,o,n)=>((e,t,o,n,r)=>{const l=eo(t),s=n.getWidths(l,n),a=n.pixelWidth(),{newSizes:c,delta:i}=r.calcRedestributedWidths(s,a,o.pixelDelta,n.isRelative);Dl(l,c,n),n.adjustTableWidth(i)})(0,t,o,n.sizing,n.resize),si=(e,t)=>D(t,(e=>0===e.column&&e.isLocked)),ai=(e,t)=>D(t,(t=>t.column+t.colspan>=e.grid.columns&&t.isLocked)),ci=(e,t)=>{const o=Wn(e),n=Ec(t);return _(n,((e,t)=>e+o[t.column].map(zn).getOr(0)),0)},ii=e=>(t,o)=>sc(t,o).filter((o=>!(e?si:ai)(t,o))).map((e=>({details:e,pixelDelta:ci(t,e)}))),di=e=>(t,o)=>lc(t,o).filter((o=>!(e?si:ai)(t,o.cells))),ui=Fc("th"),mi=Fc("td"),pi=rc(((e,t,o,n)=>{const r=t[0].row,l=Xc(t),s=M(l,((e,t)=>({grid:Rc(e.grid,r,t.row+e.delta,o,n.getOrInit),delta:e.delta+1})),{grid:e,delta:0}).grid;return Qc(s,r,t[0].column)}),sc,p,p,jc),gi=rc(((e,t,o,n)=>{const r=Xc(t),l=r[r.length-1],s=l.row+l.rowspan,a=M(r,((e,t)=>Rc(e,s,t.row,o,n.getOrInit)),e);return Qc(a,s,t[0].column)}),sc,p,p,jc),fi=rc(((e,t,o,n)=>{const r=t.details,l=Ec(r),s=l[0].column,a=M(l,((e,t)=>({grid:Dc(e.grid,s,t.column+e.delta,o,n.getOrInit),delta:e.delta+1})),{grid:e,delta:0}).grid;return Qc(a,r[0].row,s)}),ii(!0),li,p,jc),bi=rc(((e,t,o,n)=>{const r=t.details,l=r[r.length-1],s=l.column+l.colspan,a=Ec(r),c=M(a,((e,t)=>Dc(e,s,t.column,o,n.getOrInit)),e);return Qc(c,r[0].row,s)}),ii(!1),li,p,jc),hi=rc(((e,t,o,n)=>{const r=Ec(t.details),l=((e,t)=>z(e,(e=>{const o=e.cells,n=M(t,((e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e),o);return n.length>0?[fe(e.element,n,e.section,e.isNew)]:[]})))(e,A(r,(e=>e.column))),s=l.length>0?l[0].cells.length-1:0;return Qc(l,r[0].row,Math.min(r[0].column,s))}),((e,t)=>ac(e,t).map((t=>({details:t,pixelDelta:-ci(e,t)})))),li,Yc,jc),wi=rc(((e,t,o,n)=>{const r=Xc(t),l=((e,t,o)=>{const{rows:n,cols:r}=$t(e);return[...r,...n.slice(0,t),...n.slice(o+1)]})(e,r[0].row,r[r.length-1].row),s=l.length>0?l.length-1:0;return Qc(l,Math.min(t[0].row,s),t[0].column)}),sc,p,Yc,jc),yi=rc(((e,t,o,n)=>{const r=Ec(t),l=A(r,(e=>e.column)),s=Mc(e,l,!0,o,n.replaceOrInit);return Qc(s,t[0].row,t[0].column)}),ac,p,p,ui),vi=rc(((e,t,o,n)=>{const r=Ec(t),l=A(r,(e=>e.column)),s=Mc(e,l,!1,o,n.replaceOrInit);return Qc(s,t[0].row,t[0].column)}),ac,p,p,mi),Ci=rc(ei,ac,p,p,ui),Si=rc(ti,ac,p,p,mi),xi=rc(oi,ac,p,p,mi),Ti=rc(((e,t,o,n)=>{const r=_c(e,t,o,n.replaceOrInit);return Qc(r,t[0].row,t[0].column)}),ac,p,p,ui),Ri=rc(((e,t,o,n)=>{const r=_c(e,t,o,n.replaceOrInit);return Qc(r,t[0].row,t[0].column)}),ac,p,p,mi),Di=rc(((e,t,o,n)=>{const r=t.cells;Gc(r);const l=((e,t,o,n)=>{const r=$t(e).rows;if(0===r.length)return e;for(let e=t.startRow;e<=t.finishRow;e++)for(let o=t.startCol;o<=t.finishCol;o++){const t=r[e],l=Ht(t,o).isLocked;jt(t,o,ge(n(),!1,l))}return e})(e,t.bounds,0,n.merge(r));return Jc(l,m.from(r[0]))}),ic,ri,p,Hc),Oi=rc(((e,t,o,n)=>{const r=M(t,((e,t)=>uc(e,t,o,n.unmerge(t))),e);return Jc(r,m.from(t[0]))}),dc,ri,p,Hc),Ai=rc(((e,t,o,n)=>{const r=((e,t)=>{const o=Zt(e);return ec(o,t,!0)})(t.clipboard,t.generators);var l,s;return((e,t,o,n,r)=>{const l=Yt(t),s=((e,t,o)=>{const n=qt(t[0]),r=$t(t).cols.length+e.row,l=O(n-e.column,(t=>t+e.column));return{row:r,column:E(l,(e=>L(o,(t=>t!==e)))).getOr(n-1)}})(e,t,l),a=$t(o).rows,c=Sc(s,a,l),i=((e,t,o)=>{if(e.row>=t.length||e.column>qt(t[0]))return gc.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);const n=t.slice(e.row),r=n[0].cells.slice(e.column),l=qt(o[0]),s=o.length;return gc.value({rowDelta:n.length-s,colDelta:r.length-l})})(s,t,a);return i.map((e=>{const o={...e,colDelta:e.colDelta-c.length},l=vc(t,o,n),i=Yt(l),d=Sc(s,a,i);return((e,t,o,n,r,l)=>{const s=e.row,a=e.column,c=s+o.length,i=a+qt(o[0])+l.length,d=W(l,C);for(let e=s;e<c;e++){let l=0;for(let c=a;c<i;c++){if(d[c]){l++;continue}Cc(t,e,c,r)&&uc(t,Vt(t[e],c),r,n.cell);const i=c-a-l,u=Ht(o[e-s],i),m=u.element,p=n.replace(m);jt(t[e],c,ge(p,!0,u.isLocked))}}return t})(s,l,a,n,r,d)}))})((l=t.row,s=t.column,{row:l,column:s}),e,r,t.generators,o).fold((()=>Jc(e,m.some(t.element))),(e=>Qc(e,t.row,t.column)))}),((e,t)=>kt(t.element).bind((o=>oc(e,o).map((e=>({...e,generators:t.generators,clipboard:t.clipboard})))))),ri,p,jc),ki=rc(((e,t,o,n)=>{const r=$t(e).rows,l=t.cells[0].column,s=r[t.cells[0].row],a=ni(t.clipboard,t.generators,s),c=xc(l,e,a,t.generators,o);return Qc(c,t.cells[0].row,t.cells[0].column)}),di(!0),p,p,jc),Bi=rc(((e,t,o,n)=>{const r=$t(e).rows,l=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,s=r[t.cells[0].row],a=ni(t.clipboard,t.generators,s),c=xc(l,e,a,t.generators,o);return Qc(c,t.cells[0].row,t.cells[0].column)}),di(!1),p,p,jc),Ii=rc(((e,t,o,n)=>{const r=$t(e).rows,l=t.cells[0].row,s=r[l],a=ni(t.clipboard,t.generators,s),c=Tc(l,e,a,t.generators,o);return Qc(c,t.cells[0].row,t.cells[0].column)}),lc,p,p,jc),Mi=rc(((e,t,o,n)=>{const r=$t(e).rows,l=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,s=r[t.cells[0].row],a=ni(t.clipboard,t.generators,s),c=Tc(l,e,a,t.generators,o);return Qc(c,t.cells[0].row,t.cells[0].column)}),lc,p,p,jc),_i=(e,t)=>{const o=Zt(e);return sc(o,t).bind((e=>{const t=e[e.length-1],n=e[0].column,r=t.column+t.colspan,l=P(A(o.all,(e=>I(e.cells,(e=>e.column>=n&&e.column<r)))));return Wa(l)})).getOr("")},Ei=(e,t)=>{const o=Zt(e);return sc(o,t).bind(Wa).getOr("")},Ni=(e,t)=>{const o=Zt(e);return sc(o,t).bind((e=>{const t=e[e.length-1],n=e[0].row,r=t.row+t.rowspan;return(e=>{const t=A(e,(e=>La(e).type)),o=R(t,"header"),n=R(t,"footer");if(o||n){const e=R(t,"body");return!o||e||n?o||e||!n?m.none():m.some("footer"):m.some("header")}return m.some("body")})(o.all.slice(n,r))})).getOr("")},Pi=(e,t,o)=>{const n=e=>"table"===be(sl(e)),r=wa(e),l=ha(e)?p:Ea,s=t=>{switch(ia(e)){case"section":return $a();case"sectionCells":return Ua();case"cells":return Ga();default:return((e,t)=>{var o;switch((o=Zt(e),q(o.all,(e=>{const t=La(e);return"header"===t.type?m.from(t.subType):m.none()}))).getOr(t)){case"section":return Ha();case"sectionCells":return Va();case"cells":return qa()}})(t,"section")}},a=(o,n,l,a,c)=>(i,d,u=!1)=>{ul(i);const p=a(),g=U.fromDom(e.getDoc()),f=nl(l,g,r),b={sizing:va(e,i),resize:ha(e)?_l():El(),section:s(i)};return n(i)?o(p,i,d,f,b).bind((o=>{k(o.newRows,(t=>{Es(e,t.dom)})),k(o.newCells,(t=>{Ns(e,t.dom)}));const n=((o,n)=>n.cursor.fold((()=>{const n=Bt(o);return H(n).filter(ze).map((n=>{t.clear(o);const r=e.dom.createRng();return r.selectNode(n.dom),e.selection.setRng(r),Je(n,"data-mce-selected","1"),r}))}),(n=>{const r=Ma(_a,n),l=e.dom.createRng();return l.setStart(r.element.dom,r.offset),l.setEnd(r.element.dom,r.offset),e.selection.setRng(l),t.clear(o),m.some(l)})))(i,o);return ze(i)&&(ul(i),u||Ps(e,i.dom,c)),n.map((e=>({rng:e,effect:c})))})):m.none()},c=a(wi,(t=>!1===n(e)||Yl(t).rows>1),p,o,Ls),i=a(hi,(t=>!1===n(e)||Yl(t).columns>1),p,o,Ls);return{deleteRow:c,deleteColumn:i,insertRowsBefore:a(pi,C,p,o,Ls),insertRowsAfter:a(gi,C,p,o,Ls),insertColumnsBefore:a(fi,C,l,o,Ls),insertColumnsAfter:a(bi,C,l,o,Ls),mergeCells:a(Di,C,p,o,Ls),unmergeCells:a(Oi,C,p,o,Ls),pasteColsBefore:a(ki,C,p,o,Ls),pasteColsAfter:a(Bi,C,p,o,Ls),pasteRowsBefore:a(Ii,C,p,o,Ls),pasteRowsAfter:a(Mi,C,p,o,Ls),pasteCells:a(Ai,C,p,o,Ws),makeCellsHeader:a(Ti,C,p,o,Ls),unmakeCellsHeader:a(Ri,C,p,o,Ls),makeColumnsHeader:a(yi,C,p,o,Ls),unmakeColumnsHeader:a(vi,C,p,o,Ls),makeRowsHeader:a(Ci,C,p,o,Ls),makeRowsBody:a(Si,C,p,o,Ls),makeRowsFooter:a(xi,C,p,o,Ls),getTableRowType:Ni,getTableCellType:Ei,getTableColType:_i}},zi={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Li=(e,t,o,n)=>O(e,(e=>((e,t,o,n)=>{const r=U.fromTag("tr");for(let l=0;l<e;l++){const e=U.fromTag(n<t||l<o?"th":"td");l<o&&Je(e,"scope","row"),n<t&&Je(e,"scope","col"),vo(e,U.fromTag("br")),vo(r,e)}return r})(t,o,n,e))),Wi=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},ji=(e,t,o,r,l)=>{const s=ya(e),a={styles:s,attributes:Ys(e),colGroups:ca(e)};return e.undoManager.ignore((()=>{const n=((e,t,o,n,r,l=zi)=>{const s=U.fromTag("table"),a="cells"!==r;ft(s,l.styles),Qe(s,l.attributes),l.colGroups&&vo(s,(e=>{const t=U.fromTag("colgroup");return O(e,(()=>vo(t,U.fromTag("col")))),t})(t));const c=Math.min(e,o);if(a&&o>0){const e=U.fromTag("thead");vo(s,e);const l=Li(o,t,"sectionCells"===r?c:0,n);xo(e,l)}const i=U.fromTag("tbody");vo(s,i);const d=Li(a?e-c:e,t,a?0:o,n);return xo(i,d),s})(o,t,l,r,ia(e),a);Je(n,"data-mce-id","__mce");const s=(e=>{const t=U.fromTag("div"),o=U.fromDom(e.dom.cloneNode(!0));return vo(t,o),(e=>e.dom.innerHTML)(t)})(n);e.insertContent(s),e.addVisual()})),Ge(sl(e),'table[data-mce-id="__mce"]').map((t=>(ga(e)?xa(t):fa(e)?Ta(t):(pa(e)||(e=>n(e)&&-1!==e.indexOf("%"))(s.width))&&Sa(t),ul(t),et(t,"data-mce-id"),((e,t)=>{k(He(t,"tr"),(t=>{Es(e,t.dom),k(He(t,"th,td"),(t=>{Ns(e,t.dom)}))}))})(e,t),((e,t)=>{Ge(t,"td,th").each(h(Wi,e))})(e,t),t.dom))).getOr(null)},Fi=(e,t,o,n={},r)=>{const l=e=>u(e)&&e>0;if(l(t)&&l(o)){const r=n.headerRows||0,l=n.headerColumns||0;return ji(e,o,t,l,r)}return console.error(r),null},Hi=e=>()=>e().fold((()=>[]),(e=>A(e,(e=>e.dom)))),Vi=e=>t=>{const o=t.length>0?m.some(ll(t)):m.none();e(o)},qi=e=>(t,o,n={})=>{const r=Fi(e,o,t,n,"Invalid values for insertTable - rows and columns values are required to insert a table.");return e.undoManager.add(),r},$i=(e,t,o)=>{const n=vt(e,t,1);1===o||n<=1?et(e,t):Je(e,t,Math.min(o,n))};var Ui=tinymce.util.Tools.resolve("tinymce.util.Tools");const Gi=(e,t,o)=>((t,n)=>{for(let r=0;r<n.length;r++){const l=e.getStyle(n[r],o);if(void 0===t&&(t=l),t!==l)return""}return t})(void 0,e.select("td,th",t)),Ki=(e,t,o)=>{o&&e.formatter.apply("align"+o,{},t)},Yi=(e,t)=>{Ui.each("left center right".split(" "),(o=>{e.formatter.remove("align"+o,{},t)}))},Ji=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],Qi=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Xi=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Zi=e=>{return(t=e,"#",ct(t,"#")?((e,t)=>e.substring(t))(t,"#".length):t).toUpperCase();var t},ed=e=>{const t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},td=e=>(e=>({value:e}))(ed(e.red)+ed(e.green)+ed(e.blue)),od=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,nd=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,rd=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),ld=(e,t,o,n)=>{const r=parseInt(e,10),l=parseInt(t,10),s=parseInt(o,10),a=parseFloat(n);return rd(r,l,s,a)},sd=e=>{if("transparent"===e)return m.some(rd(0,0,0,0));const t=od.exec(e);if(null!==t)return m.some(ld(t[1],t[2],t[3],"1"));const o=nd.exec(e);return null!==o?m.some(ld(o[1],o[2],o[3],o[4])):m.none()},ad=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},cd=e=>{const t=ad(m.none()),o=()=>t.get().each(e);return{clear:()=>{o(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{o(),t.set(m.some(e))}}},id=()=>{const e=cd(p);return{...e,on:t=>e.get().each(t)}},dd=(e,t,o,n)=>r=>{const l=cd((e=>e.unbind())),s=!ut(n),a=()=>{const a=Cl(t),c=t=>e.formatter.match(o,{value:n},t.dom,s);s?(r.setActive(!D(a,c)),l.set(e.formatter.formatChanged(o,(e=>r.setActive(!e)),!0))):(r.setActive(L(a,c)),l.set(e.formatter.formatChanged(o,r.setActive,!1,{value:n})))};return e.initialized?a():e.on("init",a),l.clear},ud=e=>de(e,"menu"),md=e=>A(e,(e=>{const t=e.text||e.title;return ud(e)?{text:t,items:md(e.menu)}:{text:t,value:e.value}})),pd=(e,t,o,n,r)=>A(o,(o=>{const l=o.text||o.title;return ud(o)?{type:"nestedmenuitem",text:l,getSubmenuItems:()=>pd(e,t,o.menu,n,r)}:{text:l,type:"togglemenuitem",onAction:()=>r(o.value),onSetup:dd(e,t,n,o.value)}})),gd=(e,t)=>o=>{e.execCommand("mceTableApplyCellStyle",!1,{[t]:o})},fd=e=>z(e,(e=>ud(e)?[{...e,menu:fd(e.menu)}]:ut(e.value)?[e]:[])),bd=(e,t,o,n,r)=>l=>l(pd(e,t,o,n,r)),hd=(e,t,o)=>{const n=A(t,(e=>{return{text:e.title,value:"#"+(o=e.value,(t=o,(e=>Qi.test(e)||Xi.test(e))(t)?m.some({value:Zi(t)}):m.none()).orThunk((()=>sd(o).map(td))).getOrThunk((()=>{const e=document.createElement("canvas");e.height=1,e.width=1;const t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),t.fillStyle="#FFFFFF",t.fillStyle=o,t.fillRect(0,0,1,1);const n=t.getImageData(0,0,1,1).data,r=n[0],l=n[1],s=n[2],a=n[3];return td(rd(r,l,s,a))}))).value,type:"choiceitem"};var t,o}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:n.length>0?n:void 0,allowCustomColors:!1},onAction:t=>{const n="remove"===t.value?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,{[o]:n})}}]},wd=e=>()=>{const t="header"===e.queryCommandValue("mceTableRowType")?"body":"header";e.execCommand("mceTableRowType",!1,{type:t})},yd=e=>()=>{const t="th"===e.queryCommandValue("mceTableColType")?"td":"th";e.execCommand("mceTableColType",!1,{type:t})},vd=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Ji}],Cd=e=>vd.concat((e=>{const t=md(ra(e));return t.length>0?m.some({name:"class",type:"listbox",label:"Class",items:t}):m.none()})(e).toArray()),Sd=(e,t)=>{const o=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(md(Ks(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(o):o}},xd=e=>(t,o)=>{const n=t.dom;return{setAttrib:(t,r)=>{e&&!r||n.setAttrib(o,t,r)},setStyle:(t,r)=>{e&&!r||n.setStyle(o,t,r)},setFormat:(n,r)=>{e&&!r||(""===r?t.formatter.remove(n,{value:null},o,!0):t.formatter.apply(n,{value:r},o))}}},Td={normal:xd(!1),ifTruthy:xd(!0)},Rd=e=>{return ct(e,"rgb")?sd(t=e).map(td).map((e=>"#"+e.value)).getOr(t):e;var t},Dd=e=>{const t=U.fromDom(e);return{borderwidth:wt(t,"border-width").getOr(""),borderstyle:wt(t,"border-style").getOr(""),bordercolor:wt(t,"border-color").map(Rd).getOr(""),backgroundcolor:wt(t,"background-color").map(Rd).getOr("")}},Od=e=>{const t=e[0],o=e.slice(1);return k(o,(e=>{k(Z(t),(o=>{te(e,((e,n)=>{const r=t[o];""!==r&&o===n&&r!==e&&(t[o]="")}))}))})),t},Ad=(e,t,o,n)=>E(e,(e=>!c(o.formatter.matchNode(n,t+e)))).getOr(""),kd=h(Ad,["left","center","right"],"align"),Bd=h(Ad,["top","middle","bottom"],"valign"),Id=e=>Mt(U.fromDom(e)).map((t=>{const o={selection:ll(e.cells)};return Ni(t,o)})).getOr(""),Md=(e,t)=>{const o=Zt(e),n=ro(o),r=I(n,(e=>D(t,(t=>J(e.element,t)))));return A(r,(e=>({element:e.element.dom,column:ao(o,e.column).map((e=>e.element.dom))})))},_d=(e,t,o,n)=>{const r=n.getData();n.close(),e.undoManager.transact((()=>{((e,t,o,n)=>{const r=re(n,((e,t)=>o[t]!==e));ae(r)>0&&t.length>=1&&Mt(t[0]).each((o=>{const l=Md(o,t),s=ae(re(r,((e,t)=>"scope"!==t&&"celltype"!==t)))>0,a=ie(r,"celltype");(s||ie(r,"scope"))&&((e,t,o)=>{const n=1===t.length;k(t,(t=>{const r=t.element,l=n?Td.normal(e,r):Td.ifTruthy(e,r);((e,t,o)=>{e.setAttrib("scope",o.scope),e.setAttrib("class",o.class),e.setStyle("height",dl(o.height)),t.setStyle("width",dl(o.width))})(l,t.column.map((t=>n?Td.normal(e,t):Td.ifTruthy(e,t))).getOr(l),o),Xs(e)&&((e,t)=>{e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),e.setFormat("tablecellbordercolor",t.bordercolor),e.setFormat("tablecellborderstyle",t.borderstyle),e.setFormat("tablecellborderwidth",dl(t.borderwidth))})(l,o),n&&(Yi(e,r),((e,t)=>{Ui.each("top middle bottom".split(" "),(o=>{e.formatter.remove("valign"+o,{},t)}))})(e,r)),o.halign&&Ki(e,r,o.halign),o.valign&&((e,t,o)=>{o&&e.formatter.apply("valign"+o,{},t)})(e,r,o.valign)}))})(e,l,n),a&&((e,t)=>{e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})})(e,n),Ps(e,o.dom,{structure:a,style:s})}))})(e,t,o,r),e.focus()}))},Ed=(e,t)=>{const o=Cl(t);if(0===o.length)return;const n=((e,t)=>{const o=Mt(t[0]).map((o=>A(Md(o,t),(t=>((e,t,o,n)=>{const r=e.dom,l=(e,t)=>r.getStyle(e,t)||r.getAttrib(e,t);return{width:l(n.getOr(t),"width"),height:l(t,"height"),scope:r.getAttrib(t,"scope"),celltype:(s=t,s.nodeName.toLowerCase()),class:r.getAttrib(t,"class",""),halign:kd(e,t),valign:Bd(e,t),...o?Dd(t):{}};var s})(e,t.element,Xs(e),t.column)))));return Od(o.getOrDie())})(e,o),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:Cd(e)},Sd(e,"cell")]},l={type:"panel",items:[{type:"grid",columns:2,items:Cd(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:Xs(e)?r:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:h(_d,e,o,n)})},Nd=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Pd=e=>Nd.concat((e=>{const t=md(la(e));return t.length>0?m.some({name:"class",type:"listbox",label:"Class",items:t}):m.none()})(e).toArray()),zd=(e,t,o,n)=>{const r=n.getData();n.close(),e.undoManager.transact((()=>{((e,t,o,n)=>{const r=re(n,((e,t)=>o[t]!==e));if(ae(r)>0){const l=ie(r,"type"),s=!l||ae(r)>1;s&&((e,t,o,n)=>{const r=1===t.length;k(t,(t=>{const l=r?Td.normal(e,t):Td.ifTruthy(e,t);((e,t)=>{e.setAttrib("class",t.class),e.setStyle("height",dl(t.height))})(l,o),Zs(e)&&((e,t)=>{e.setStyle("background-color",t.backgroundcolor),e.setStyle("border-color",t.bordercolor),e.setStyle("border-style",t.borderstyle)})(l,o),o.align!==n.align&&(Yi(e,t),Ki(e,t,o.align))}))})(e,t,n,o),l&&((e,t)=>{e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})})(e,n),Mt(U.fromDom(t[0])).each((t=>Ps(e,t.dom,{structure:l,style:s})))}})(e,t,o,r),e.focus()}))},Ld=e=>{const t=((e,t)=>{const o=vl(e),n=o.bind((e=>Mt(e))).map((e=>_t(e)));return rt(o,n,((e,o)=>I(o,(o=>D(ll(o.dom.cells),(o=>"1"===Xe(o,t)||J(o,e))))))).getOr([])})(ml(e),bl.selected);if(0===t.length)return;const o=A(t,(t=>((e,t,o)=>{const n=e.dom;return{height:n.getStyle(t,"height")||n.getAttrib(t,"height"),class:n.getAttrib(t,"class",""),type:Id(t),align:kd(e,t),...o?Dd(t):{}}})(e,t.dom,Zs(e)))),n=Od(o),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:Pd(e)},Sd(e,"row")]},l={type:"panel",items:[{type:"grid",columns:2,items:Pd(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:Zs(e)?r:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:h(zd,e,A(t,(e=>e.dom)),n)})},Wd=(e,t,o)=>{const n=o?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],r=ta(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],l=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return n.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(r).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(l)},jd=(e,t,o,r)=>{if("TD"===t.tagName||"TH"===t.tagName)n(o)?e.setStyle(t,o,r):e.setStyles(t,o);else if(t.children)for(let n=0;n<t.children.length;n++)jd(e,t.children[n],o,r)},Fd=(e,t,o,n)=>{const r=e.dom,l=n.getData(),s=re(l,((e,t)=>o[t]!==e));n.close(),""===l.class&&delete l.class,e.undoManager.transact((()=>{if(!t){const o=parseInt(l.cols,10)||1,n=parseInt(l.rows,10)||1;t=ji(e,o,n,0,0)}if(ae(s)>0){((e,t,o)=>{const n=e.dom,r={},l={};if(r.class=o.class,l.height=dl(o.height),n.getAttrib(t,"width")&&!na(e)?r.width=(e=>e?e.replace(/px$/,""):"")(o.width):l.width=dl(o.width),na(e)?(l["border-width"]=dl(o.border),l["border-spacing"]=dl(o.cellspacing)):(r.border=o.border,r.cellpadding=o.cellpadding,r.cellspacing=o.cellspacing),na(e)&&t.children)for(let r=0;r<t.children.length;r++)jd(n,t.children[r],{"border-width":dl(o.border),padding:dl(o.cellpadding)}),ea(e)&&jd(n,t.children[r],{"border-color":o.bordercolor});ea(e)&&(l["background-color"]=o.backgroundcolor,l["border-color"]=o.bordercolor,l["border-style"]=o.borderstyle),r.style=n.serializeStyle({...ya(e),...l}),n.setAttribs(t,{...Ys(e),...r})})(e,t,l);const o=r.select("caption",t)[0];(o&&!l.caption||!o&&l.caption)&&e.execCommand("mceTableToggleCaption"),""===l.align?Yi(e,t):Ki(e,t,l.align)}if(e.focus(),e.addVisual(),ae(s)>0){const o=ie(s,"caption"),n=!o||ae(s)>1;Ps(e,t,{structure:o,style:n})}}))},Hd=(e,t)=>{const o=e.dom;let n,r=((e,t)=>{const o=ya(e),n=Ys(e),r=t?{borderstyle:ce(o,"border-style").getOr(""),bordercolor:Rd(ce(o,"border-color").getOr("")),backgroundcolor:Rd(ce(o,"background-color").getOr(""))}:{};return{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:"",...o,...n,...r,...(()=>{const t=o["border-width"];return na(e)&&t?{border:t}:ce(n,"border").fold((()=>({})),(e=>({border:e})))})(),...{...ce(o,"border-spacing").or(ce(n,"cellspacing")).fold((()=>({})),(e=>({cellspacing:e}))),...ce(o,"border-padding").or(ce(n,"cellpadding")).fold((()=>({})),(e=>({cellpadding:e})))}}})(e,ea(e));!1===t?(n=o.getParent(e.selection.getStart(),"table",e.getBody()),n?r=((e,t,o)=>{const n=e.dom,r=na(e)?n.getStyle(t,"border-spacing")||n.getAttrib(t,"cellspacing"):n.getAttrib(t,"cellspacing")||n.getStyle(t,"border-spacing"),l=na(e)?Gi(n,t,"padding")||n.getAttrib(t,"cellpadding"):n.getAttrib(t,"cellpadding")||Gi(n,t,"padding");return{width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),cellspacing:r,cellpadding:l,border:((t,o)=>{const n=wt(U.fromDom(o),"border-width");return na(e)&&n.isSome()?n.getOr(""):t.getAttrib(o,"border")||Gi(e.dom,o,"border-width")||Gi(e.dom,o,"border")})(n,t),caption:!!n.select("caption",t)[0],class:n.getAttrib(t,"class",""),align:kd(e,t),...o?Dd(t):{}}})(e,n,ea(e)):ea(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor="")):(r.cols="1",r.rows="1",ea(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor=""));const l=md(sa(e));l.length>0&&r.class&&(r.class=r.class.replace(/\s*mce\-item\-table\s*/g,""));const s={type:"grid",columns:2,items:Wd(e,l,t)},a=ea(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[s]},Sd(e,"table")]}:{type:"panel",items:[s]};e.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:h(Fd,e,n,r),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r})},Vd=e=>yl(ml(e),il(e)),qd=(e,t,o,l,s)=>{const a=il(e),c=e=>Mt(e,a),i=t=>(e=>vl(ml(e),il(e)))(e).bind((e=>c(e).map((o=>t(o,e))))),d=t=>{e.focus()},u=(e,t=!1)=>i(((o,n)=>{const r=hl(l,o,n);e(o,r,t).each(d)})),g=()=>i(((t,o)=>((e,t,o)=>{const n=Zt(e);return sc(n,t).bind((e=>{const t=ec(n,o,!1),r=$t(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),l=z(r,(e=>{const t=I(e.cells,(e=>!e.isLocked));return t.length>0?[{...e,cells:t}]:[]})),s=tc(l);return lt(s.length>0,s)})).map((e=>A(e,(e=>{const t=Xo(e.element);return k(e.cells,(e=>{const o=Zo(e.element);Ya(o,"colspan",e.colspan,1),Ya(o,"rowspan",e.rowspan,1),vo(t,o)})),t}))))})(t,hl(l,t,o),nl(p,U.fromDom(e.getDoc()),m.none())))),f=()=>i(((e,t)=>((e,t)=>{const o=Zt(e);return ac(o,t).map((e=>{const t=e[e.length-1],n=e[0].column,r=t.column+t.colspan,l=((e,t,o)=>{if(so(e)){const n=I(lo(e),(e=>e.column>=t&&e.column<o)),r=A(n,(e=>{const n=Zo(e.element);return $i(n,"span",o-t),n})),l=U.fromTag("colgroup");return xo(l,r),[l]}return[]})(o,n,r),s=((e,t,o)=>A(e.all,(e=>{const n=I(e.cells,(e=>e.column>=t&&e.column<o)),r=A(n,(e=>{const n=Zo(e.element);return $i(n,"colspan",o-t),n})),l=U.fromTag("tr");return xo(l,r),l})))(o,n,r);return[...l,...s]}))})(e,hl(l,e,t)))),b=(t,o)=>o().each((o=>{const n=A(o,(e=>Zo(e)));i(((o,r)=>{const s=rl(U.fromDom(e.getDoc())),a=((e,t,o,n)=>({selection:pl(e),clipboard:o,generators:n}))(l,0,n,s);t(o,a).each(d)}))})),y=e=>(t,o)=>ce(o,"type").each((t=>{u(e(t),o.no_events)}));te({mceTableSplitCells:()=>u(t.unmergeCells),mceTableMergeCells:()=>u(t.mergeCells),mceTableInsertRowBefore:()=>u(t.insertRowsBefore),mceTableInsertRowAfter:()=>u(t.insertRowsAfter),mceTableInsertColBefore:()=>u(t.insertColumnsBefore),mceTableInsertColAfter:()=>u(t.insertColumnsAfter),mceTableDeleteCol:()=>u(t.deleteColumn),mceTableDeleteRow:()=>u(t.deleteRow),mceTableCutCol:()=>f().each((e=>{s.setColumns(e),u(t.deleteColumn)})),mceTableCutRow:()=>g().each((e=>{s.setRows(e),u(t.deleteRow)})),mceTableCopyCol:()=>f().each((e=>s.setColumns(e))),mceTableCopyRow:()=>g().each((e=>s.setRows(e))),mceTablePasteColBefore:()=>b(t.pasteColsBefore,s.getColumns),mceTablePasteColAfter:()=>b(t.pasteColsAfter,s.getColumns),mceTablePasteRowBefore:()=>b(t.pasteRowsBefore,s.getRows),mceTablePasteRowAfter:()=>b(t.pasteRowsAfter,s.getRows),mceTableDelete:()=>Vd(e).each((t=>{Mt(t,a).filter(w(a)).each((t=>{const o=U.fromText("");if(wo(t,o),Ro(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{const t=e.dom.createRng();t.setStart(o.dom,0),t.setEnd(o.dom,0),e.selection.setRng(t),e.nodeChanged()}}))})),mceTableCellToggleClass:(t,o)=>{i((t=>{const n=Cl(l),r=L(n,(t=>e.formatter.match("tablecellclass",{value:o},t.dom))),s=r?e.formatter.remove:e.formatter.apply;k(n,(e=>s("tablecellclass",{value:o},e.dom))),Ps(e,t.dom,zs)}))},mceTableToggleClass:(t,o)=>{i((t=>{e.formatter.toggle("tableclass",{value:o},t.dom),Ps(e,t.dom,zs)}))},mceTableToggleCaption:()=>{Vd(e).each((t=>{Mt(t,a).each((o=>{Ue(o,"caption").fold((()=>{const t=U.fromTag("caption");vo(t,U.fromText("Caption")),((e,t,o)=>{Me(e,0).fold((()=>{vo(e,t)}),(e=>{ho(e,t)}))})(o,t),e.selection.setCursorLocation(t.dom,0)}),(n=>{Te("caption")(t)&&Y("td",o).each((t=>e.selection.setCursorLocation(t.dom,0))),Ro(n)})),Ps(e,o.dom,Ls)}))}))},mceTableSizingMode:(t,o)=>(t=>Vd(e).each((o=>{fa(e)||ga(e)||pa(e)||Mt(o,a).each((o=>{"relative"!==t||Ul(o)?"fixed"!==t||Gl(o)?"responsive"!==t||Kl(o)||Ta(o):xa(o):Sa(o),ul(o),Ps(e,o.dom,Ls)}))})))(o),mceTableCellType:y((e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader)),mceTableColType:y((e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader)),mceTableRowType:y((e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}}))},((t,o)=>e.addCommand(o,t))),te({mceTableProps:h(Hd,e,!1),mceTableRowProps:h(Ld,e),mceTableCellProps:h(Ed,e,l)},((t,o)=>e.addCommand(o,(()=>t())))),e.addCommand("mceInsertTable",((t,o)=>{r(o)&&Z(o).length>0?Fi(e,o.rows,o.columns,o.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Hd(e,!0)})),e.addCommand("mceTableApplyCellStyle",((t,o)=>{const s=e=>"tablecell"+e.toLowerCase().replace("-","");if(!r(o))return;const a=Cl(l);if(0===a.length)return;const i=re(o,((t,o)=>e.formatter.has(s(o))&&n(t)));(e=>{for(const t in e)if(ee.call(e,t))return!1;return!0})(i)||(te(i,((t,o)=>{k(a,(n=>{Td.normal(e,n.dom).setFormat(s(o),t)}))})),c(a[0]).each((t=>Ps(e,t.dom,zs))))}))},$d={remove_similar:!0,inherit:!1},Ud={selector:"td,th",...$d},Gd={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...Ud},tablecellverticalalign:{styles:{"vertical-align":"%value"},...Ud},tablecellbordercolor:{styles:{borderColor:"%value"},...Ud},tablecellclass:{classes:["%value"],...Ud},tableclass:{selector:"table",classes:["%value"],...$d},tablecellborderstyle:{styles:{borderStyle:"%value"},...Ud},tablecellborderwidth:{styles:{borderWidth:"%value"},...Ud}},Kd=qo([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Yd={...Kd,none:e=>Kd.none(e)},Jd=(e,t,o,n,r=C)=>{const l=1===n;if(!l&&o<=0)return Yd.first(e[0]);if(l&&o>=e.length-1)return Yd.last(e[e.length-1]);{const l=o+n,s=e[l];return r(s)?Yd.middle(t,s):Jd(e,t,l,n,r)}},Qd=(e,t)=>Mt(e,t).bind((t=>{const o=Bt(t);return N(o,(t=>J(e,t))).map((e=>({index:e,all:o})))})),Xd=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),Zd=qo([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),eu={before:Zd.before,on:Zd.on,after:Zd.after,cata:(e,t,o,n)=>e.fold(t,o,n),getStart:e=>e.fold(f,f,f)},tu=qo([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ou={domRange:tu.domRange,relative:tu.relative,exact:tu.exact,exactFromRange:e=>tu.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{const t=(e=>e.match({domRange:e=>U.fromDom(e.startContainer),relative:(e,t)=>eu.getStart(e),exact:(e,t,o,n)=>e}))(e);return U.fromDom(De(t).dom.defaultView)},range:Xd},nu=(e,t)=>{const o=e.document.createRange();return o.selectNode(t.dom),o},ru=(e,t)=>{const o=e.document.createRange();return lu(o,t),o},lu=(e,t)=>e.selectNodeContents(t.dom),su=(e,t,o)=>{const n=e.document.createRange();var r;return r=n,t.fold((e=>{r.setStartBefore(e.dom)}),((e,t)=>{r.setStart(e.dom,t)}),(e=>{r.setStartAfter(e.dom)})),((e,t)=>{t.fold((t=>{e.setEndBefore(t.dom)}),((t,o)=>{e.setEnd(t.dom,o)}),(t=>{e.setEndAfter(t.dom)}))})(n,o),n},au=(e,t,o,n,r)=>{const l=e.document.createRange();return l.setStart(t.dom,o),l.setEnd(n.dom,r),l},cu=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),iu=qo([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),du=(e,t,o)=>t(U.fromDom(o.startContainer),o.startOffset,U.fromDom(o.endContainer),o.endOffset),uu=(e,t)=>{const o=((e,t)=>t.match({domRange:e=>({ltr:g(e),rtl:m.none}),relative:(t,o)=>({ltr:tn((()=>su(e,t,o))),rtl:tn((()=>m.some(su(e,o,t))))}),exact:(t,o,n,r)=>({ltr:tn((()=>au(e,t,o,n,r))),rtl:tn((()=>m.some(au(e,n,r,t,o))))})}))(e,t);return((e,t)=>{const o=t.ltr();return o.collapsed?t.rtl().filter((e=>!1===e.collapsed)).map((e=>iu.rtl(U.fromDom(e.endContainer),e.endOffset,U.fromDom(e.startContainer),e.startOffset))).getOrThunk((()=>du(0,iu.ltr,o))):du(0,iu.ltr,o)})(0,o)},mu=(e,t)=>uu(e,t).match({ltr:(t,o,n,r)=>{const l=e.document.createRange();return l.setStart(t.dom,o),l.setEnd(n.dom,r),l},rtl:(t,o,n,r)=>{const l=e.document.createRange();return l.setStart(n.dom,r),l.setEnd(t.dom,o),l}});iu.ltr,iu.rtl;const pu=document.caretPositionFromPoint?(e,t,o)=>{var n,r;return m.from(null===(r=(n=e.dom).caretPositionFromPoint)||void 0===r?void 0:r.call(n,t,o)).bind((t=>{if(null===t.offsetNode)return m.none();const o=e.dom.createRange();return o.setStart(t.offsetNode,t.offset),o.collapse(),m.some(o)}))}:document.caretRangeFromPoint?(e,t,o)=>{var n,r;return m.from(null===(r=(n=e.dom).caretRangeFromPoint)||void 0===r?void 0:r.call(n,t,o))}:m.none,gu=(e,t)=>{const o=be(e);return"input"===o?eu.after(e):R(["br","img"],o)?0===t?eu.before(e):eu.after(e):eu.on(e,t)},fu=(e,t)=>{const o=e.fold(eu.before,gu,eu.after),n=t.fold(eu.before,gu,eu.after);return ou.relative(o,n)},bu=(e,t,o,n)=>{const r=gu(e,t),l=gu(o,n);return ou.relative(r,l)},hu=e=>m.from(e.getSelection()),wu=(e,t)=>{hu(e).each((e=>{e.removeAllRanges(),e.addRange(t)}))},yu=(e,t,o,n,r)=>{const l=au(e,t,o,n,r);wu(e,l)},vu=(e,t)=>uu(e,t).match({ltr:(t,o,n,r)=>{yu(e,t,o,n,r)},rtl:(t,o,n,r)=>{hu(e).each((l=>{if(l.setBaseAndExtent)l.setBaseAndExtent(t.dom,o,n.dom,r);else if(l.extend)try{((e,t,o,n,r,l)=>{t.collapse(o.dom,n),t.extend(r.dom,l)})(0,l,t,o,n,r)}catch(l){yu(e,n,r,t,o)}else yu(e,n,r,t,o)}))}}),Cu=(e,t,o,n,r)=>{const l=bu(t,o,n,r);vu(e,l)},Su=(e,t,o)=>{const n=fu(t,o);vu(e,n)},xu=e=>{if(e.rangeCount>0){const t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return m.some(Xd(U.fromDom(t.startContainer),t.startOffset,U.fromDom(o.endContainer),o.endOffset))}return m.none()},Tu=e=>{if(null===e.anchorNode||null===e.focusNode)return xu(e);{const t=U.fromDom(e.anchorNode),o=U.fromDom(e.focusNode);return((e,t,o,n)=>{const r=((e,t,o,n)=>{const r=Re(e).dom.createRange();return r.setStart(e.dom,t),r.setEnd(o.dom,n),r})(e,t,o,n),l=J(e,o)&&t===n;return r.collapsed&&!l})(t,e.anchorOffset,o,e.focusOffset)?m.some(Xd(t,e.anchorOffset,o,e.focusOffset)):xu(e)}},Ru=(e,t,o=!0)=>{const n=(o?ru:nu)(e,t);wu(e,n)},Du=e=>(e=>hu(e).filter((e=>e.rangeCount>0)).bind(Tu))(e).map((e=>ou.exact(e.start,e.soffset,e.finish,e.foffset)));var Ou=tinymce.util.Tools.resolve("tinymce.util.VK");const Au=(e,t,o)=>{return Bu(e,t,(r=ws,Qd(n=o,void 0).fold((()=>Yd.none(n)),(e=>Jd(e.all,n,e.index,1,r)))));var n,r},ku=(e,t,o)=>{return Bu(e,t,(r=ws,Qd(n=o,void 0).fold((()=>Yd.none()),(e=>Jd(e.all,n,e.index,-1,r)))));var n,r},Bu=(e,t,o)=>o.fold(m.none,m.none,((e,t)=>Gr(t).map((e=>((e,t)=>(e=>{const t=ou.getWin(e).dom,o=(e,o,n,r)=>au(t,e,o,n,r),n=(e=>e.match({domRange:e=>{const t=U.fromDom(e.startContainer),o=U.fromDom(e.endContainer);return bu(t,e.startOffset,o,e.endOffset)},relative:fu,exact:bu}))(e);return uu(t,n).match({ltr:o,rtl:o})})(ou.exact(t,0,t,0)))(0,e)))),(o=>(e.execCommand("mceTableInsertRowAfter"),Au(e,t,o)))),Iu=["table","li","dl"],Mu=(e,t)=>({selection:e,kill:t}),_u=(e,t,o,n)=>({start:eu.on(e,t),finish:eu.on(o,n)}),Eu=(e,t)=>{const o=mu(e,t);return Xd(U.fromDom(o.startContainer),o.startOffset,U.fromDom(o.endContainer),o.endOffset)},Nu=_u,Pu=(e,t,o,n,r)=>J(o,n)?m.none():Lo(o,n,t).bind((t=>{const n=t.boxes.getOr([]);return n.length>1?(r(e,n,t.start,t.finish),m.some(Mu(m.some(Nu(o,0,o,qr(o))),!0))):m.none()})),zu=(e,t)=>({item:e,mode:t}),Lu=(e,t,o,n=Wu)=>e.property().parent(t).map((e=>zu(e,n))),Wu=(e,t,o,n=ju)=>o.sibling(e,t).map((e=>zu(e,n))),ju=(e,t,o,n=ju)=>{const r=e.property().children(t);return o.first(r).map((e=>zu(e,n)))},Fu=[{current:Lu,next:Wu,fallback:m.none()},{current:Wu,next:ju,fallback:m.some(Lu)},{current:ju,next:ju,fallback:m.some(Wu)}],Hu=(e,t,o,n,r=Fu)=>E(r,(e=>e.current===o)).bind((o=>o.current(e,t,n,o.next).orThunk((()=>o.fallback.bind((o=>Hu(e,t,o,n))))))),Vu=(e,t,o,n,r,l)=>Hu(e,t,n,r).bind((t=>l(t.item)?m.none():o(t.item)?m.some(t.item):Vu(e,t.item,o,t.mode,r,l))),qu=e=>t=>0===e.property().children(t).length,$u=(e,t,o,n)=>Vu(e,t,o,Wu,{sibling:(e,t)=>e.query().prevSibling(t),first:e=>e.length>0?m.some(e[e.length-1]):m.none()},n),Uu=(e,t,o,n)=>Vu(e,t,o,Wu,{sibling:(e,t)=>e.query().nextSibling(t),first:e=>e.length>0?m.some(e[0]):m.none()},n),Gu=Mo(),Ku=(e,t)=>((e,t,o)=>$u(e,t,qu(e),o))(Gu,e,t),Yu=(e,t)=>((e,t,o)=>Uu(e,t,qu(e),o))(Gu,e,t),Ju=qo([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Qu=e=>Ke(e,"tr"),Xu={...Ju,verify:(e,t,o,n,r,l,s)=>Ke(n,"td,th",s).bind((o=>Ke(t,"td,th",s).map((t=>J(o,t)?J(n,o)&&qr(o)===r?l(t):Ju.none("in same cell"):Po(Qu,[o,t]).fold((()=>((e,t,o)=>{const n=e.getRect(t),r=e.getRect(o);return r.right>n.left&&r.left<n.right})(e,t,o)?Ju.success():l(t)),(e=>l(t))))))).getOr(Ju.none("default")),cata:(e,t,o,n,r)=>e.fold(t,o,n,r)},Zu=Te("br"),em=(e,t,o)=>t(e,o).bind((e=>Ce(e)&&0===Ao(e).trim().length?em(e,t,o):m.some(e))),tm=(e,t,o,n)=>((e,t)=>Me(e,t).filter(Zu).orThunk((()=>Me(e,t-1).filter(Zu))))(t,o).bind((t=>n.traverse(t).fold((()=>em(t,n.gather,e).map(n.relative)),(e=>(e=>Oe(e).bind((t=>{const o=Ie(t);return((e,t)=>N(e,h(J,t)))(o,e).map((n=>((e,t,o,n)=>({parent:e,children:t,element:o,index:n}))(t,o,e,n)))})))(e).map((e=>eu.on(e.parent,e.index))))))),om=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),nm=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),rm=(e,t,o)=>({left:e.left+t,top:e.top+o,right:e.right+t,bottom:e.bottom+o}),lm=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),sm=(e,t)=>m.some(e.getRect(t)),am=(e,t,o)=>ve(t)?sm(e,t).map(lm):Ce(t)?((e,t,o)=>o>=0&&o<qr(t)?e.getRangedRect(t,o,t,o+1):o>0?e.getRangedRect(t,o-1,t,o):m.none())(e,t,o).map(lm):m.none(),cm=(e,t)=>ve(t)?sm(e,t).map(lm):Ce(t)?e.getRangedRect(t,0,t,qr(t)).map(lm):m.none(),im=qo([{none:[]},{retry:["caret"]}]),dm=(e,t,o)=>{return(n=t,r=$c,Ve(((e,t)=>t(e)),qe,n,r,undefined)).fold(v,(t=>cm(e,t).exists((e=>((e,t)=>e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right)(o,e)))));var n,r},um={point:e=>e.bottom,adjuster:(e,t,o,n,r)=>{const l=om(r,5);return Math.abs(o.bottom-n.bottom)<1||o.top>r.bottom?im.retry(l):o.top===r.bottom?im.retry(om(r,1)):dm(e,t,r)?im.retry(rm(l,5,0)):im.none()},move:om,gather:Yu},mm=(e,t,o,n,r)=>0===r?m.some(n):((e,t,o)=>e.elementFromPoint(t,o).filter((e=>"table"===be(e))).isSome())(e,n.left,t.point(n))?((e,t,o,n,r)=>mm(e,t,o,t.move(n,5),r))(e,t,o,n,r-1):e.situsFromPoint(n.left,t.point(n)).bind((l=>l.start.fold(m.none,(l=>cm(e,l).bind((s=>t.adjuster(e,l,s,o,n).fold(m.none,(n=>mm(e,t,o,n,r-1))))).orThunk((()=>m.some(n)))),m.none))),pm=(e,t,o)=>{const n=e.move(o,5),r=mm(t,e,o,n,100).getOr(n);return((e,t,o)=>e.point(t)>o.getInnerHeight()?m.some(e.point(t)-o.getInnerHeight()):e.point(t)<0?m.some(-e.point(t)):m.none())(e,r,t).fold((()=>t.situsFromPoint(r.left,e.point(r))),(o=>(t.scrollBy(0,o),t.situsFromPoint(r.left,e.point(r)-o))))},gm={tryUp:h(pm,{point:e=>e.top,adjuster:(e,t,o,n,r)=>{const l=nm(r,5);return Math.abs(o.top-n.top)<1||o.bottom<r.top?im.retry(l):o.bottom===r.top?im.retry(nm(r,1)):dm(e,t,r)?im.retry(rm(l,5,0)):im.none()},move:nm,gather:Ku}),tryDown:h(pm,um),getJumpSize:g(5)},fm=(e,t,o)=>e.getSelection().bind((n=>((e,t,o,n)=>{const r=Zu(t)?((e,t,o)=>o.traverse(t).orThunk((()=>em(t,o.gather,e))).map(o.relative))(e,t,n):tm(e,t,o,n);return r.map((e=>({start:e,finish:e})))})(t,n.finish,n.foffset,o).fold((()=>m.some(Aa(n.finish,n.foffset))),(r=>{const l=e.fromSitus(r);return s=Xu.verify(e,n.finish,n.foffset,l.finish,l.foffset,o.failure,t),Xu.cata(s,(e=>m.none()),(()=>m.none()),(e=>m.some(Aa(e,0))),(e=>m.some(Aa(e,qr(e)))));var s})))),bm=(e,t,o,n,r,l)=>0===l?m.none():ym(e,t,o,n,r).bind((s=>{const a=e.fromSitus(s),c=Xu.verify(e,o,n,a.finish,a.foffset,r.failure,t);return Xu.cata(c,(()=>m.none()),(()=>m.some(s)),(s=>J(o,s)&&0===n?hm(e,o,n,nm,r):bm(e,t,s,0,r,l-1)),(s=>J(o,s)&&n===qr(s)?hm(e,o,n,om,r):bm(e,t,s,qr(s),r,l-1)))})),hm=(e,t,o,n,r)=>am(e,t,o).bind((t=>wm(e,r,n(t,gm.getJumpSize())))),wm=(e,t,o)=>{const n=Mn().browser;return n.isChromium()||n.isSafari()||n.isFirefox()?t.retry(e,o):m.none()},ym=(e,t,o,n,r)=>am(e,o,n).bind((t=>wm(e,r,t))),vm=(e,t,o,n,r)=>Ke(n,"td,th",t).bind((n=>Ke(n,"table",t).bind((l=>((e,t)=>qe(e,(e=>Oe(e).exists((e=>J(e,t)))),void 0).isSome())(r,l)?((e,t,o)=>fm(e,t,o).bind((n=>bm(e,t,n.element,n.offset,o,20).map(e.fromSitus))))(e,t,o).bind((e=>Ke(e.finish,"td,th",t).map((t=>({start:n,finish:t,range:e}))))):m.none())))),Cm=(e,t,o,n,r,l)=>l(n,t).orThunk((()=>vm(e,t,o,n,r).map((e=>{const t=e.range;return Mu(m.some(Nu(t.start,t.soffset,t.finish,t.foffset)),!0)})))),Sm=(e,t)=>Ke(e,"tr",t).bind((e=>Ke(e,"table",t).bind((o=>{const n=He(o,"tr");return J(e,n[0])?((e,t,o)=>$u(Gu,e,(e=>Kr(e).isSome()),o))(o,0,t).map((e=>{const t=qr(e);return Mu(m.some(Nu(e,t,e,t)),!0)})):m.none()})))),xm=(e,t)=>Ke(e,"tr",t).bind((e=>Ke(e,"table",t).bind((o=>{const n=He(o,"tr");return J(e,n[n.length-1])?((e,t,o)=>Uu(Gu,e,(e=>Gr(e).isSome()),o))(o,0,t).map((e=>Mu(m.some(Nu(e,0,e,0)),!0))):m.none()})))),Tm=(e,t,o,n,r,l,s)=>vm(e,o,n,r,l).bind((e=>Pu(t,o,e.start,e.finish,s))),Rm=(e,t)=>Ke(e,"td,th",t),Dm={traverse:Be,gather:Yu,relative:eu.before,retry:gm.tryDown,failure:Xu.failedDown},Om={traverse:ke,gather:Ku,relative:eu.before,retry:gm.tryUp,failure:Xu.failedUp},Am=e=>t=>t===e,km=Am(38),Bm=Am(40),Im=e=>e>=37&&e<=40,Mm={isBackward:Am(37),isForward:Am(39)},_m={isBackward:Am(39),isForward:Am(37)},Em=e=>({elementFromPoint:(t,o)=>U.fromPoint(U.fromDom(e.document),t,o),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(t,o,n,r)=>{const l=ou.exact(t,o,n,r);return((e,t)=>(e=>{const t=e.getClientRects(),o=t.length>0?t[0]:e.getBoundingClientRect();return o.width>0||o.height>0?m.some(o).map(cu):m.none()})(mu(e,t)))(e,l)},getSelection:()=>Du(e).map((t=>Eu(e,t))),fromSitus:t=>{const o=ou.relative(t.start,t.finish);return Eu(e,o)},situsFromPoint:(t,o)=>((e,t,o)=>((e,t,o)=>{const n=U.fromDom(e.document);return pu(n,t,o).map((e=>Xd(U.fromDom(e.startContainer),e.startOffset,U.fromDom(e.endContainer),e.endOffset)))})(e,t,o))(e,t,o).map((e=>_u(e.start,e.soffset,e.finish,e.foffset))),clearSelection:()=>{(e=>{hu(e).each((e=>e.removeAllRanges()))})(e)},collapseSelection:(t=!1)=>{Du(e).each((o=>o.fold((e=>e.collapse(t)),((o,n)=>{const r=t?o:n;Su(e,r,r)}),((o,n,r,l)=>{const s=t?o:r,a=t?n:l;Cu(e,s,a,s,a)}))))},setSelection:t=>{Cu(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:(t,o)=>{Su(e,t,o)},selectNode:t=>{Ru(e,t,!1)},selectContents:t=>{Ru(e,t)},getInnerHeight:()=>e.innerHeight,getScrollY:()=>(e=>{const t=void 0!==e?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,n=t.body.scrollTop||t.documentElement.scrollTop;return Kn(o,n)})(U.fromDom(e.document)).top,scrollBy:(t,o)=>{((e,t,o)=>{const n=(void 0!==o?o.dom:document).defaultView;n&&n.scrollBy(e,t)})(t,o,U.fromDom(e.document))}}),Nm=(e,t)=>({rows:e,cols:t}),Pm=e=>!1===ps(U.fromDom(e.target),"ephox-snooker-resizer-bar");var zm=(e,t,o)=>{const n=((e,t,o)=>{const n=t=>{et(t,e.selected),et(t,e.firstSelected),et(t,e.lastSelected)},r=t=>{Je(t,e.selected,"1")},l=e=>{s(e),o()},s=t=>{const o=He(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);k(o,n)};return{clearBeforeUpdate:s,clear:l,selectRange:(o,n,s,a)=>{l(o),k(n,r),Je(s,e.firstSelected,"1"),Je(a,e.lastSelected,"1"),t(n,s,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}})(bl,((t,n,r)=>{o.targets().each((o=>{Mt(n).each((l=>{const s=wa(e),a=nl(p,U.fromDom(e.getDoc()),s),c=((e,t,o)=>{const n=Zt(e);return sc(n,t).map((e=>{const t=ec(n,o,!1),r=((e,t)=>{const o=e.slice(0,t[t.length-1].row+1),n=tc(o);return z(n,(e=>{const o=e.cells.slice(0,t[t.length-1].column+1);return A(o,(e=>e.element))}))})(t,e),l=((e,t)=>{const o=e.slice(t[0].row+t[0].rowspan-1,e.length),n=tc(o);return z(n,(e=>{const o=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return A(o,(e=>e.element))}))})(t,e);return{upOrLeftCells:r,downOrRightCells:l}}))})(l,o,a);((e,t,o,n,r)=>{e.fire("TableSelectionChange",{cells:t,start:o,finish:n,otherCells:r})})(e,t,n,r,c)}))}))}),(()=>(e=>{e.fire("TableSelectionClear")})(e)));return e.on("init",(o=>{const r=e.getWin(),l=sl(e),s=il(e),a=((e,t,o,n)=>{const r=((e,t,o,n)=>{const r=id(),l=r.clear,s=l=>{r.on((r=>{n.clearBeforeUpdate(t),Rm(l.target,o).each((s=>{Lo(r,s,o).each((o=>{const r=o.boxes.getOr([]);if(1===r.length){const o=r[0],s="false"===ys(o),a=ot(hs(l.target),o,J);s&&a&&(n.selectRange(t,r,o,o),e.selectContents(o))}else r.length>1&&(n.selectRange(t,r,o.start,o.finish),e.selectContents(s))}))}))}))};return{clearstate:l,mousedown:e=>{n.clear(t),Rm(e.target,o).each(r.set)},mouseover:e=>{s(e)},mouseup:e=>{s(e),l()}}})(Em(e),t,o,n);return{clearstate:r.clearstate,mousedown:r.mousedown,mouseover:r.mouseover,mouseup:r.mouseup}})(r,l,s,n),c=((e,t,o,n)=>{const r=Em(e),l=()=>(n.clear(t),m.none());return{keydown:(e,s,a,c,i,d)=>{const u=e.raw,p=u.which,g=!0===u.shiftKey,f=Wo(t,n.selectedSelector).fold((()=>(Im(p)&&!g&&n.clearBeforeUpdate(t),Bm(p)&&g?h(Tm,r,t,o,Dm,c,s,n.selectRange):km(p)&&g?h(Tm,r,t,o,Om,c,s,n.selectRange):Bm(p)?h(Cm,r,o,Dm,c,s,xm):km(p)?h(Cm,r,o,Om,c,s,Sm):m.none)),(e=>{const o=o=>()=>{const l=q(o,(o=>((e,t,o,n,r)=>Fo(n,e,t,r.firstSelectedSelector,r.lastSelectedSelector).map((e=>(r.clearBeforeUpdate(o),r.selectRange(o,e.boxes,e.start,e.finish),e.boxes))))(o.rows,o.cols,t,e,n)));return l.fold((()=>jo(t,n.firstSelectedSelector,n.lastSelectedSelector).map((e=>{const o=Bm(p)||d.isForward(p)?eu.after:eu.before;return r.setRelativeSelection(eu.on(e.first,0),o(e.table)),n.clear(t),Mu(m.none(),!0)}))),(e=>m.some(Mu(m.none(),!0))))};return Bm(p)&&g?o([Nm(1,0)]):km(p)&&g?o([Nm(-1,0)]):d.isBackward(p)&&g?o([Nm(0,-1),Nm(-1,0)]):d.isForward(p)&&g?o([Nm(0,1),Nm(1,0)]):Im(p)&&!g?l:m.none}));return f()},keyup:(e,r,l,s,a)=>Wo(t,n.selectedSelector).fold((()=>{const c=e.raw,i=c.which;return!0===c.shiftKey&&Im(i)?((e,t,o,n,r,l,s)=>J(o,r)&&n===l?m.none():Ke(o,"td,th",t).bind((o=>Ke(r,"td,th",t).bind((n=>Pu(e,t,o,n,s))))))(t,o,r,l,s,a,n.selectRange):m.none()}),m.none)}})(r,l,s,n),i=((e,t,o,n)=>{const r=Em(e);return(e,l)=>{n.clearBeforeUpdate(t),Lo(e,l,o).each((e=>{const o=e.boxes.getOr([]);n.selectRange(t,o,e.start,e.finish),r.selectContents(l),r.collapseSelection()}))}})(r,l,s,n);e.on("TableSelectorChange",(e=>i(e.start,e.finish)));const d=(t,o)=>{(e=>!0===e.raw.shiftKey)(t)&&(o.kill&&t.kill(),o.selection.each((t=>{const o=ou.relative(t.start,t.finish),n=mu(r,o);e.selection.setRng(n)})))},u=e=>0===e.button,g=(()=>{const e=ad(U.fromDom(l)),t=ad(0);return{touchEnd:o=>{const n=U.fromDom(o.target);if(Te("td")(n)||Te("th")(n)){const r=e.get(),l=t.get();J(r,n)&&o.timeStamp-l<300&&(o.preventDefault(),i(n,n))}e.set(n),t.set(o.timeStamp)}}})();e.on("dragstart",(e=>{a.clearstate()})),e.on("mousedown",(e=>{u(e)&&Pm(e)&&a.mousedown(is(e))})),e.on("mouseover",(e=>{var t;void 0!==(t=e).buttons&&0==(1&t.buttons)||!Pm(e)||a.mouseover(is(e))})),e.on("mouseup",(e=>{u(e)&&Pm(e)&&a.mouseup(is(e))})),e.on("touchend",g.touchEnd),e.on("keyup",(t=>{const o=is(t);if(o.raw.shiftKey&&Im(o.raw.which)){const t=e.selection.getRng(),n=U.fromDom(t.startContainer),r=U.fromDom(t.endContainer);c.keyup(o,n,t.startOffset,r,t.endOffset).each((e=>{d(o,e)}))}})),e.on("keydown",(o=>{const n=is(o);t().each((e=>e.hideBars()));const r=e.selection.getRng(),l=U.fromDom(r.startContainer),s=U.fromDom(r.endContainer),a=Hn(Mm,_m)(U.fromDom(e.selection.getStart()));c.keydown(n,l,r.startOffset,s,r.endOffset,a).each((e=>{d(n,e)})),t().each((e=>e.showBars()))})),e.on("NodeChange",(()=>{const t=e.selection,o=U.fromDom(t.getStart()),r=U.fromDom(t.getEnd());Po(Mt,[o,r]).fold((()=>n.clear(l)),p)}))})),{clear:n.clear}};const Lm=(e,t)=>{const o=ad(m.none()),n=ad([]);let r=m.none();const l=Te("caption"),s=e=>r.forall((t=>!t[e])),a=()=>yl(ml(e),il(e)).bind((o=>{return n=rt(Mt(o),yl((e=>U.fromDom(e.selection.getEnd()))(e),il(e)).bind(Mt),((e,n)=>J(e,n)?l(o)?m.some((e=>({element:e,mergable:m.none(),unmergable:m.none(),selection:[e]}))(o)):m.some(hl(t,e,o)):m.none())),n.bind(f);var n})),c=e=>Mt(e.element).map((t=>{const o=Zt(t),n=sc(o,e).getOr([]),r=_(n,((e,t)=>(t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=o.grid.columns&&(e.onLast=!0)),e)),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:ic(o,e).isSome(),unmergeable:dc(o,e).isSome(),locked:r}})),i=()=>{o.set(tn(a)()),r=o.get().bind(c),k(n.get(),(e=>e()))},d=e=>(e(),n.set(n.get().concat([e])),()=>{n.set(I(n.get(),(t=>t!==e)))}),u=(e,t)=>d((()=>o.get().fold((()=>{e.setDisabled(!0)}),(o=>{e.setDisabled(t(o))})))),p=(e,t,n)=>d((()=>o.get().fold((()=>{e.setDisabled(!0),e.setActive(!1)}),(o=>{e.setDisabled(t(o)),e.setActive(n(o))})))),g=e=>r.exists((t=>t.locked[e])),b=(t,o)=>n=>p(n,(e=>l(e.element)),(()=>e.queryCommandValue(t)===o)),h=b("mceTableRowType","header"),w=b("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",i),{onSetupTable:e=>u(e,(e=>!1)),onSetupCellOrRow:e=>u(e,(e=>l(e.element))),onSetupColumn:e=>t=>u(t,(t=>l(t.element)||g(e))),onSetupPasteable:e=>t=>u(t,(t=>l(t.element)||e().isNone())),onSetupPasteableColumn:(e,t)=>o=>u(o,(o=>l(o.element)||e().isNone()||g(t))),onSetupMergeable:e=>u(e,(e=>s("mergeable"))),onSetupUnmergeable:e=>u(e,(e=>s("unmergeable"))),resetTargets:i,onSetupTableWithCaption:t=>p(t,v,(t=>Mt(t.element,il(e)).exists((e=>Ue(e,"caption").isSome())))),onSetupTableRowHeaders:h,onSetupTableColumnHeaders:w,targets:o.get}};Jo.add("table",(e=>{(e=>{const t=e.options.register;t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_border_widths",{processor:"object[]",default:Vs}),t("table_border_styles",{processor:"object[]",default:qs}),t("table_default_attributes",{processor:"object",default:Fs}),t("table_default_styles",{processor:"object",default:Hs}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("table_cell_advtab",{processor:"boolean",default:!0}),t("table_row_advtab",{processor:"boolean",default:!0}),t("table_advtab",{processor:"boolean",default:!0}),t("table_appearance_options",{processor:"boolean",default:!0}),t("table_grid",{processor:"boolean",default:!js.deviceType.isTouch()}),t("table_style_by_css",{processor:"boolean",default:!1}),t("table_cell_class_list",{processor:"object[]",default:[]}),t("table_row_class_list",{processor:"object[]",default:[]}),t("table_class_list",{processor:"object[]",default:[]}),t("table_toolbar",{processor:"string",default:"tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"}),t("table_use_colgroups",{processor:"boolean",default:!1}),t("table_header_type",{processor:e=>{const t=R(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_column_resizing",{processor:e=>{const t=R(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_clone_elements",{processor:"string[]"}),t("table_background_color_map",{processor:"object[]",default:[]}),t("table_border_color_map",{processor:"object[]",default:[]})})(e);const t=(a=bl.selectedSelector,{get:()=>Ho(sl(e),a).fold((()=>vl(ml(e),il(e)).fold(Go,Yo)),(e=>Ko(e)))}),o=Lm(e,t),n=Oa(e),r=zm(e,n.lazyResize,o),l=Pi(e,r,n.lazyWire),s=(()=>{const e=id(),t=id();return{getRows:e.get,setRows:o=>{o.fold(e.clear,e.set),t.clear()},clearRows:e.clear,getColumns:t.get,setColumns:o=>{o.fold(t.clear,t.set),e.clear()},clearColumns:t.clear}})();var a;return qd(e,l,0,t,s),((e,t,o)=>{const n=il(e),r=t=>vl(ml(e)).bind((e=>Mt(e,n).map((n=>{const r=hl(o,n,e);return t(n,r)})))).getOr("");te({mceTableRowType:()=>r(t.getTableRowType),mceTableCellType:()=>r(t.getTableCellType),mceTableColType:()=>r(t.getTableColType)},((t,o)=>e.addQueryValueHandler(o,t)))})(e,l,t),Sl(e,t,l),((e,t,o,n)=>{const r=t=>()=>e.execCommand(t),l=t=>{e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},s={text:"Table properties",onSetup:o.onSetupTable,onAction:r("mceTableProps")},a={text:"Delete table",icon:"table-delete-table",onSetup:o.onSetupTable,onAction:r("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:o.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:o.onSetupPasteable(n.getRows)});const c={type:"nestedmenuitem",text:"Row",getSubmenuItems:g("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:o.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:o.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:o.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:o.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:o.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:o.onSetupPasteableColumn(n.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:o.onSetupPasteableColumn(n.getColumns,"onLast")});const i={type:"nestedmenuitem",text:"Column",getSubmenuItems:g("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:o.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:o.onSetupUnmergeable});const d={type:"nestedmenuitem",text:"Cell",getSubmenuItems:g("tablecellprops tablemergecells tablesplitcells")};oa(e)?e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:l}]}):e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",s),e.ui.registry.addMenuItem("deletetable",a),e.ui.registry.addNestedMenuItem("row",c),e.ui.registry.addNestedMenuItem("column",i),e.ui.registry.addNestedMenuItem("cell",d),e.ui.registry.addContextMenu("table",{update:()=>(o.resetTargets(),o.targets().fold(g(""),(e=>"caption"===be(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable")))});const u=fd(sa(e));0!==u.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>pd(e,t,u,"tableclass",(t=>e.execCommand("mceTableToggleClass",!1,t))),onSetup:o.onSetupTable});const m=fd(ra(e));0!==m.length&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>pd(e,t,m,"tablecellclass",(t=>e.execCommand("mceTableCellToggleClass",!1,t))),onSetup:o.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>pd(e,t,Ji,"tablecellverticalalign",gd(e,"vertical-align")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>pd(e,t,Gs(e),"tablecellborderwidth",gd(e,"border-width")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>pd(e,t,Ks(e),"tablecellborderstyle",gd(e,"border-style")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:r("mceTableToggleCaption"),onSetup:o.onSetupTableWithCaption}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>hd(e,ua(e),"background-color"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>hd(e,ma(e),"border-color"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:wd(e),onSetup:o.onSetupTableRowHeaders}),e.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:yd(e),onSetup:o.onSetupTableColumnHeaders})})(e,t,o,s),((e,t,o,n)=>{e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:e=>e("inserttable | cell row column | advtablesort | tableprops deletetable")});const r=t=>()=>e.execCommand(t);e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:o.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:o.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:o.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:o.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:o.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:o.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:o.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:o.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:o.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:o.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:o.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:o.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:o.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:o.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:o.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:o.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:o.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:o.onSetupPasteableColumn(n.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:o.onSetupPasteableColumn(n.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"});const l=fd(sa(e));0!==l.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:bd(e,t,l,"tableclass",(t=>e.execCommand("mceTableToggleClass",!1,t))),onSetup:o.onSetupTable});const s=fd(ra(e));0!==s.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:bd(e,t,s,"tablecellclass",(t=>e.execCommand("mceTableCellToggleClass",!1,t))),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:bd(e,t,Ji,"tablecellverticalalign",gd(e,"vertical-align")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:bd(e,t,Gs(e),"tablecellborderwidth",gd(e,"border-width")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:bd(e,t,Ks(e),"tablecellborderstyle",gd(e,"border-style")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:r("mceTableToggleCaption"),icon:"table-caption",onSetup:o.onSetupTableWithCaption}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:t=>t(hd(e,ua(e),"background-color")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:t=>t(hd(e,ma(e),"border-color")),onSetup:o.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:wd(e),onSetup:o.onSetupTableRowHeaders}),e.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:yd(e),onSetup:o.onSetupTableColumnHeaders})})(e,t,o,s),(e=>{const t=aa(e);t.length>0&&e.ui.registry.addContextToolbar("table",{predicate:t=>e.dom.is(t,"table")&&e.getBody().contains(t),items:t,scope:"node",position:"node"})})(e),e.on("PreInit",(()=>{e.serializer.addTempAttr(bl.firstSelected),e.serializer.addTempAttr(bl.lastSelected),(e=>{e.formatter.register(Gd)})(e)})),Qs(e)&&e.on("keydown",(t=>{((e,t,o)=>{if(e.keyCode===Ou.TAB){const n=sl(t),r=e=>{const t=be(e);return J(e,n)||R(Iu,t)},l=t.selection.getRng(),s=U.fromDom(e.shiftKey?l.startContainer:l.endContainer);kt(s,r).each((n=>{e.preventDefault(),Mt(n,r).each(o.clear),t.selection.collapse(e.shiftKey),(e.shiftKey?ku:Au)(t,r,n).each((e=>{t.selection.setRng(e)}))}))}})(t,e,r)})),e.on("remove",(()=>{n.destroy()})),((e,t,o,n)=>({insertTable:qi(e),setClipboardRows:Vi(t.setRows),getClipboardRows:Hi(t.getRows),setClipboardCols:Vi(t.setColumns),getClipboardCols:Hi(t.getColumns),resizeHandler:o,selectionTargets:n}))(e,s,n,o)}))}();
